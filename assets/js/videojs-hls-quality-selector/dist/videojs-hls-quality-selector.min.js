/**
 * videojs-hls-quality-selector
 * @version 1.1.1
 * @copyright 2020 Chris Boustead (chris@forgemotion.com)
 * @license MIT
 */
!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e(require("video.js")):"function"==typeof define&&define.amd?define(["video.js"],e):t.videojsHlsQualitySelector=e(t.videojs)}(this,function(o){"use strict";o=o&&o.hasOwnProperty("default")?o.default:o;var l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};"function"==typeof Symbol&&Symbol.asyncIterator&&(t.prototype[Symbol.asyncIterator]=function(){return this}),t.prototype.next=function(t){return this._invoke("next",t)},t.prototype.throw=function(t){return this._invoke("throw",t)},t.prototype.return=function(t){return this._invoke("return",t)};function a(t){this.value=t}function t(o){var r,l;function s(t,e){try{var n=o[t](e),i=n.value;i instanceof a?Promise.resolve(i.value).then(function(t){s("next",t)},function(t){s("throw",t)}):u(n.done?"return":"normal",n.value)}catch(t){u("throw",t)}}function u(t,e){switch(t){case"return":r.resolve({value:e,done:!0});break;case"throw":r.reject(e);break;default:r.resolve({value:e,done:!1})}(r=r.next)?s(r.key,r.arg):l=null}this._invoke=function(i,o){return new Promise(function(t,e){var n={key:i,arg:o,resolve:t,reject:e,next:null};l?l=l.next=n:(r=l=n,s(i,o))})},"function"!=typeof o.return&&(this.return=void 0)}function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function e(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function s(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}var n=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},i=o.getComponent("MenuButton"),u=o.getComponent("Menu"),c=o.getComponent("Component"),h=o.dom;var p,y=(e(f,p=i),f.prototype.createItems=function(){return[]},f.prototype.createMenu=function(){var t,e,n,i=new u(this.player_,{menuButton:this});if(this.hideThreshold_=0,this.options_.title&&(t=h.createEl("li",{className:"vjs-menu-title",innerHTML:"string"!=typeof(n=this.options_.title)?n:n.charAt(0).toUpperCase()+n.slice(1),tabIndex:-1}),e=new c(this.player_,{el:t}),this.hideThreshold_+=1,i.addItem(e)),this.items=this.createItems(),this.items)for(var o=0;o<this.items.length;o++)i.addItem(this.items[o]);return i},f);function f(t){return r(this,f),s(this,p.call(this,t,{title:t.localize("Quality")}))}var d,v=o.getComponent("MenuItem"),m=(e(g,d=v),g.prototype.handleClick=function(){for(var t=0;t<this.qualityButton.items.length;++t)this.qualityButton.items[t].selected(!1);this.plugin.setQuality(this.item.value),this.selected(!0)},g);function g(t,e,n,i){r(this,g);var o=s(this,d.call(this,t,{label:e.label,selectable:!0,selected:e.selected||!1}));return o.item=e,o.qualityButton=n,o.plugin=i,o}var b={positionIndex:-2,identifyBy:"height"},_=o.registerPlugin||o.plugin,I=(B.prototype.getHls=function(){return this.player.tech({IWillNotUseThisInPlugins:!0}).hls},B.prototype.bindPlayerEvents=function(){this.player.qualityLevels().on("addqualitylevel",this.onAddQualityLevel.bind(this))},B.prototype.createQualityButton=function(){var t=this.player;this._qualityButton=new y(t);var e,n=this._options.parent,i=n.children().length+this._options.positionIndex,o=n.addChild(this._qualityButton,{componentClass:"qualitySelector"},i);o.addClass("vjs-quality-selector"),this.config.displayCurrentQuality?this.setButtonInnerText("auto"):(e=" "+(this.config.vjsIconClass||"vjs-icon-hd"),o.menuButton_.$(".vjs-icon-placeholder").className+=e),o.removeClass("vjs-hidden")},B.prototype.getIdentifierFromLevel=function(t,e){var n=t[this._options.identifyBy]||t.height;if(e)switch(this._options.identifyBy){case"bitrate":for(var i=["","k","M","G","T"],o=0;1e3<Math.floor(n)&&o<i.length;)n/=1e3,o++;return Math.floor(n)+i[o]+"bps";case"height":return n+"p";default:return n}return n},B.prototype.setButtonInnerText=function(t){this._qualityButton.menuButton_.$(".vjs-icon-placeholder").innerHTML=t},B.prototype.getQualityMenuItem=function(t){var e=this.player;return new m(e,t,this._qualityButton,this)},B.prototype.onAddQualityLevel=function(){for(var n=this,t=this.player,i=t.qualityLevels().levels_||[],o=[],e=function(e){var t;o.filter(function(t){return t.item&&t.item.value===n.getIdentifierFromLevel(i[e])}).length||(t=n.getQualityMenuItem.call(n,{label:n.getIdentifierFromLevel(i[e],!0),value:n.getIdentifierFromLevel(i[e])}),o.push(t))},r=0;r<i.length;++r)e(r);o.sort(function(t,e){return"object"!==(void 0===t?"undefined":l(t))||"object"!==(void 0===e?"undefined":l(e))||t.item.value<e.item.value?-1:t.item.value>e.item.value?1:0}),o.push(this.getQualityMenuItem.call(this,{label:t.localize("Auto"),value:"auto",selected:!0})),this._qualityButton&&(this._qualityButton.createItems=function(){return o},this._qualityButton.update())},B.prototype.setQuality=function(t){var e=this.player.qualityLevels();this.config.displayCurrentQuality&&this.setButtonInnerText("auto"===t?t:t+"p");for(var n=0;n<e.length;++n){var i=e[n];i.enabled=this.getIdentifierFromLevel(i)===t||"auto"===t}this._qualityButton.unpressButton()},B);function B(t,e){r(this,B),this.player=t,this.config=e,this._options=n(b,e),this._options.parent=t.controlBar,this.player.qualityLevels&&this.getHls()&&(this.createQualityButton(),this.bindPlayerEvents())}function j(n){var i=this;this.ready(function(){var t,e;t=i,e=o.mergeOptions(b,n),t.addClass("vjs-hls-quality-selector"),t.hlsQualitySelector=new I(t,e)})}return _("hlsQualitySelector",j),j.VERSION="1.1.1",j});