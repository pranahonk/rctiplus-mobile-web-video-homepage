var loadConviva=void 0===ConvivaPrivateLoader;function convivaBrowserSupportsVideoElement(){try{return!!document.createElement("video").canPlayType}catch(e){return!1}}function convivaBrowserSupportsLocalStorage(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}var convivaSupportedBrowser=convivaBrowserSupportsVideoElement()&&convivaBrowserSupportsLocalStorage();if(loadConviva=loadConviva&&convivaSupportedBrowser){var ConvivaPrivateLoader=void 0!==ConvivaPrivateLoader?ConvivaPrivateLoader:function(){};!function(){function registerName(cls,clsname){"undefined"!=typeof ConvivaPrivateModule?ConvivaPrivateModule[clsname]=cls:"undefined"!=typeof ConvivaPrivateTestingModule?ConvivaPrivateTestingModule[clsname]=cls:ConvivaPrivateLoader[clsname]=cls}function __id(x){return x}function getConvivaType(className){return"undefined"!=typeof ConvivaPrivateModule&&ConvivaPrivateModule.hasOwnProperty(className)?ConvivaPrivateModule[className]:"undefined"!=typeof ConvivaPrivateTestingModule&&ConvivaPrivateTestingModule.hasOwnProperty(className)?ConvivaPrivateTestingModule[className]:ConvivaPrivateLoader.hasOwnProperty(className)?ConvivaPrivateLoader[className]:null}function importConvivaPrivateProgram(fromWhere,fromWhereName){var res="",p;for(p in fromWhere)fromWhere.hasOwnProperty(p)&&(res+="var "+p+"="+fromWhereName+"."+p+";");return res}function STAT_INIT(){return"STAT_INIT"}function statInit(cls,clsname){cls.call(STAT_INIT),registerName(cls,clsname)}function defPubMeth(obj,name,m){obj!=STAT_INIT&&(null==obj[name]?obj[name]=m:obj["super_"+name]=m)}function defPrivMeth(obj,name,m){obj!=STAT_INIT&&(obj[name]=m)}function defStatMeth(obj,cls,name,m){obj==STAT_INIT&&(cls[name]=m)}function defGet(obj,name,m){obj!=STAT_INIT&&(void 0!==Object.defineProperty?Object.defineProperty(obj,name,{configurable:!0,enumerable:!0,get:m}):obj.__defineGetter__(name,m))}function defSet(obj,name,m){obj!=STAT_INIT&&(void 0!==Object.defineProperty?Object.defineProperty(obj,name,{configurable:!0,set:m}):obj.__defineSetter__(name,m))}function defStatGet(obj,cls,name,m){obj==STAT_INIT&&defGet(cls,name,m)}function defStatSet(obj,cls,name,m){obj==STAT_INIT&&defSet(cls,name,m)}function slIsArray(inObj){return inObj.constructor==Array||void 0!==inObj.length}function slForEachPropValue(a,f){var ist=slIsArray(a);if(slIsArray(a))for(var i=0;i<a.length;i++)f(a[i]);else for(var p in a)a.hasOwnProperty(p)&&f(a[p])}function slForEachProp(a,f){if(slIsArray(a))for(var i=0;i<a.length;i++)f(i);else for(var p in a)a.hasOwnProperty(p)&&f(p)}function declTestClass(obj,name,cls,meta){obj==STAT_INIT&&jstest.DeclareTestClass(name,cls,meta)}function declTestMethod(obj,clsname,mname,mcode,meta){obj==STAT_INIT?jstest.DeclareTestMethod(clsname,mname,meta):jstest.SetTestMethodClosure(clsname,mname,mcode)}function sluint(){sluint.two32=4294967296,sluint.Cast=function(v){var vi=parseInt(v);return vi>sluint.MaxValue?vi%=sluint.two32:vi<0&&(vi=-vi%sluint.two32,vi=sluint.two32-vi),vi},sluint.uintRegex=new RegExp("^[0-9]+$"),sluint.Parse=function(v){return Lang.parseChecker(v,sluint.uintRegex),sluint.Cast(v)},sluint.MaxValue=sluint.two32-1,sluint.MinValue=0}function slint(){slint.Cast=function(v){var vu=sluint.Cast(v);return vu>slint.MaxValue&&(vu-=sluint.two32),vu},slint.intRegex=new RegExp("^[+-]?[0-9]+$"),slint.Parse=function(v){return Lang.parseChecker(v,slint.intRegex),slint.Cast(v)},slint.MaxValue=2147483647,slint.MinValue=-2147483648}function Int64(){var _s=this;function __constr(){_s._l=0,_s._h=0}function __fromUnsignedInt(i){var res=new Int64;return res._h=0,res._l=i,res}function __fromInt(i){var res=new Int64;return i>=0?(res._h=0,res._l=sluint.Cast(i)):(res._h=-1,res._l=sluint.Cast(i)),res}function __fromNumber(n){var l1=n%Int64.TWO_TO_32;l1<0&&(l1=Number(sluint.MaxValue)+1+l1);var res=new Int64;return res._l=sluint.Cast(l1+.5),res._h=slint.Cast((n-l1)/Int64.TWO_TO_32),res}function __asNumber(){return Number(_s._h)*Int64.TWO_TO_32+Number(_s._l)}_s==STAT_INIT&&(Int64.TWO_TO_32=4294967296),defStatMeth(_s,Int64,"fromUnsignedInt",__fromUnsignedInt),defStatMeth(_s,Int64,"fromInt",__fromInt),defStatMeth(_s,Int64,"fromNumber",__fromNumber),defGet(_s,"asNumber",__asNumber),_s!=STAT_INIT&&(this.toString=function(){return _s.asNumber.toString()}),_s!=STAT_INIT&&__constr.apply(this,arguments)}function UInt64(){var _s=this;function __constr(){Int64.call(_s),_s._l=0,_s._h=0}function __fromUnsignedInt(i){var res=new UInt64;return res._h=0,res._l=i,res}function __fromNumber(n){var res=new UInt64;return res._h=Math.floor(n/Int64.TWO_TO_32),res._l=n%Int64.TWO_TO_32,res}defStatMeth(_s,UInt64,"fromUnsignedInt",__fromUnsignedInt),defStatMeth(_s,UInt64,"fromNumber",__fromNumber),_s!=STAT_INIT&&__constr.apply(arguments)}function CandidateStream(){var _s=this;function _constr(id,bitrate,resource){_s.id=id,_s.bitrate=bitrate,_s.resource=resource}function __Cleanup(){_s.id=null,_s.bitrate=0,_s.resource=null}function __get_id(){return _s.__auto_id}function __set_id(value){_s.__auto_id=value}function __get_bitrate(){return _s.__auto_bitrate}function __set_bitrate(value){_s.__auto_bitrate=value}function __get_resource(){return _s.__auto_resource}function __set_resource(value){_s.__auto_resource=value}function __CheckValidity(){return null!=_s.id&&"string"!=typeof _s.id?"CandidateStream.id is not a string":null!=_s.bitrate&&"number"!=typeof _s.bitrate?"CandidateStream.bitrate is not an int":null!=_s.resource&&"string"!=typeof _s.resource?"CandidateStream.resource is not a string":null}function __ConstructClone(fromObj){if(null==fromObj)return null;var res=new CandidateStream("",-1,null);return res.id=NativeLang.GetStringField("id",fromObj),res.bitrate=slint.Cast(NativeLang.GetField("bitrate",fromObj)),res.resource=NativeLang.GetStringField("resource",fromObj),res}defPubMeth(_s,"Cleanup",__Cleanup),_s!=STAT_INIT&&(_s.__auto_id=void 0),defGet(_s,"id",__get_id),defSet(_s,"id",__set_id),_s!=STAT_INIT&&(_s.__auto_bitrate=void 0),defGet(_s,"bitrate",__get_bitrate),defSet(_s,"bitrate",__set_bitrate),_s!=STAT_INIT&&(_s.__auto_resource=void 0),defGet(_s,"resource",__get_resource),defSet(_s,"resource",__set_resource),defPubMeth(_s,"CheckValidity",__CheckValidity),defStatMeth(_s,CandidateStream,"ConstructClone",__ConstructClone),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function ConvivaContentInfo(){var _s=this;function __get_tags(){return Lang.StringDictionaryToRepr(_s._tags)}function __set_tags(value){_s._tags=Lang.DictionaryFromRepr(value)}function __get_isLive(){return _s._isLive}function __set_isLive(value){var utils;("true"===value&&(value=!0),"false"===value&&(value=!1),!0!==value&&!1!==value)&&Utils.getInstance().err("Ignoring invalid value for ConvivaContentInfo.isLive, expected boolean.");"boolean"==typeof value&&(_s._isLive=value)}function _constr(assetName,tags){null!=assetName&&"string"==typeof assetName&&(_s.assetName=assetName),"object"!=typeof tags&&"object"!=typeof assetName||(null!=tags&&"object"==typeof tags?_s._tags=tags:null!=assetName&&"object"==typeof assetName&&(_s._tags=assetName)),null==_s._tags&&(_s._tags=new DictionaryCS)}_s==STAT_INIT&&(ConvivaContentInfo.FRAMEWORK_NAME_BRIGHTCOVE="Brightcove"),_s==STAT_INIT&&(ConvivaContentInfo.FRAMEWORK_NAME_KALTURA="Kaltura"),_s==STAT_INIT&&(ConvivaContentInfo.FRAMEWORK_NAME_OOYALA="Ooyala"),_s==STAT_INIT&&(ConvivaContentInfo.FRAMEWORK_NAME_OSMF="OSMF"),_s==STAT_INIT&&(ConvivaContentInfo.FRAMEWORK_NAME_THE_PLATFORM="thePlatform"),_s==STAT_INIT&&(ConvivaContentInfo.DEVICE_TYPE_CONSOLE="Console"),_s==STAT_INIT&&(ConvivaContentInfo.DEVICE_TYPE_MOBILE="Mobile"),_s==STAT_INIT&&(ConvivaContentInfo.DEVICE_TYPE_PC="PC"),_s==STAT_INIT&&(ConvivaContentInfo.DEVICE_TYPE_SET_TOP_BOX="Settop"),_s==STAT_INIT&&(ConvivaContentInfo.PLUGIN_NAME_KALTURA="ConvivaKalturaPlugin"),_s==STAT_INIT&&(ConvivaContentInfo.NO_RESOURCE="no_resource"),_s!=STAT_INIT&&(_s.assetName=null),_s!=STAT_INIT&&(_s.duration=-1),_s!=STAT_INIT&&(_s.encodedFps=-1),_s!=STAT_INIT&&(_s._tags=null),defGet(_s,"tags",__get_tags),defSet(_s,"tags",__set_tags),_s!=STAT_INIT&&(_s.defaultReportingResource=null),_s!=STAT_INIT&&(_s.frameworkName=null),_s!=STAT_INIT&&(_s.frameworkVersion=null),_s!=STAT_INIT&&(_s.pluginName=null),_s!=STAT_INIT&&(_s.pluginVersion=null),_s!=STAT_INIT&&(_s.viewerId=null),_s!=STAT_INIT&&(_s.deviceId=null),_s!=STAT_INIT&&(_s.deviceType=null),_s!=STAT_INIT&&(_s.playerName=null),_s!=STAT_INIT&&(_s.streamUrl=null),_s!=STAT_INIT&&(_s._isLive="unknown"),defGet(_s,"isLive",__get_isLive),defSet(_s,"isLive",__set_isLive),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function ConvivaStreamerProxy(){var _s=this;function _constr(){}function __Cleanup(){null!=_s._notifiers&&_s._notifiers.Clear()}function __GetCapabilities(){return 0}function __GetPlayheadTimeMs(){return-1}function __GetIsPHTAccurate(){return!0}function __GetBufferLengthMs(){return-1}function __GetVideoBufferLengthMs(){return-1}function __GetAudioBufferLengthMs(){return-1}function __GetStartingBufferLengthMs(){return-1}function __SetStartingBufferLengthMs(ms){}function __GetIsStartingBufferFull(){return!1}function __GetRenderedFrameRate(){return-1}function __GetSourceFrameRate(){return-1}function __GetDroppedFrames(){return-1}function __GetCpuPercent(){return-1}function __GetMemoryAvailable(){return-1}function __GetCapacityKbps(resource){return-1}function __GetServerAddress(){return null}function __GetIsLive(){return ConvivaStreamerProxy.BOOLEAN_UNAVAILABLE}function __GetStreamerVersion(){return-1}function __GetSignalStrength(){return 1e3}function __FetchCandidateStreams(resource){}function __Play(destination){}function __GetApiVersion(){return ConvivaStreamerProxy.API_VERSION}function __SetMonitoringNotifier(notifier){if(null!=notifier){var previousNotifiers=_s._notifiers,newNotifiers=new ListCS;if(newNotifiers.Add(notifier),_s._notifiers=newNotifiers,null!=_s._notifiers){_s.isProxyInitialized&&notifier(ConvivaStreamerProxy.REASON_PROXYINITIALIZED,null),_s.SetDownloadStateChange(StreamInfo.VIDEO,ConvivaStreamerProxy.DOWNLOADSTATE_ACTIVE),_s.SetDownloadStateChange(StreamInfo.AUDIO,ConvivaStreamerProxy.DOWNLOADSTATE_ACTIVE);var newInfo=_s._stream;_s._stream=new StreamInfo(-1,ConvivaContentInfo.NO_RESOURCE,-1,-1,-1),_s.SetStream(newInfo),_s._playingState=ConvivaStreamerProxy.UNKNOWN,_s.SetPlayingState(_s._playingState);for(var _for_array_1=_s._pendingErrors.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var strErr=_for_array_1[_for_idx_2];_s.SetError(strErr)}var newStreams=_s._availableStreams;_s._availableStreams=null,_s.SetAvailableStreams(newStreams);var newChunkDownloadStatus=_s._currentLoadingStatus;_s._currentLoadingStatus=null,_s.SetLoadingStatus(newChunkDownloadStatus);var newDisplayWidth=_s._displayWidth,newDisplayHeight=_s._displayHeight;_s._displayWidth=-1,_s._displayHeight=-1,_s.SetDisplaySize(newDisplayWidth,newDisplayHeight)}previousNotifiers.Add(notifier),_s._notifiers=previousNotifiers}}function __GetLoadingStatus(){return _s._currentLoadingStatus}function __GetPlayingState(){return _s._playingState}function __GetBitrateKbps(){return _s._stream.bitrateKbps}function __GetResource(){return _s._stream.resource}function __GetStream(){return _s._stream}function __GetStreams(){return null}function __GetLastError(){return _s._lastError}function __GetLastMetadata(){return _s._lastMetadata}function __GetDisplayWidth(){return _s._displayWidth}function __GetDisplayHeight(){return _s._displayHeight}function __GetStreamerType(){return null}function __GetLoadedBytes(){return-1}function __SetDownloadStateChange(type,state){var downloadStateChange=new ListCS;downloadStateChange.Add(type),downloadStateChange.Add(state);for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_DOWNLOADSTATECHANGE,downloadStateChange)}}function __SetStream(updatedStream){if(updatedStream.bitrateKbps<=-2&&(updatedStream.bitrateKbps=_s._stream.bitrateKbps),null==updatedStream.resource&&(updatedStream.resource=_s._stream.resource),!_s._stream.equals(updatedStream))for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_STREAMINFOCHANGE,updatedStream)}_s._stream=updatedStream}function __SetError(error){if(_s._lastError=error,null!=_s._notifiers&&_s._notifiers.Count>0){for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_ERRORCHANGE,error)}_s._pendingErrors.Remove(error)}else _s._pendingErrors.Add(error)}function __SetMetadata(metadata){if(_s._lastMetadata=metadata,null!=metadata)for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_METADATACHANGE,metadata)}}function __Log(message){for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_LOG,message)}}function __LogError(message){for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_LOG,"ERROR:"+message)}}function __GetTotalLoadedBytes(){return null}function __SetLoadingStatus(loadingStatus){if(_s._currentLoadingStatus=loadingStatus,null!=loadingStatus)for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_LOADINGSTATUSCHANGE,loadingStatus)}}function __SetPlayingState(newState){if(newState!=_s._playingState)for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_PLAYINGSTATECHANGE,newState)}_s._playingState=newState}function __SetBitrateKbps(updatedBitrateKbps){var updatedStream=new StreamInfo(updatedBitrateKbps,null,-1,-1,-1);_s.SetStream(updatedStream)}function __SetResource(updatedResource){var updatedStream=new StreamInfo(-2,updatedResource,-1,-1,-1);_s.SetStream(updatedStream)}function __SetDisplaySize(displayWidth,displayHeight){if(-1!=displayWidth&&-1!=displayHeight){_s._displayWidth=displayWidth,_s._displayHeight=displayHeight;var displaySize=new DictionaryCS;displaySize.Add("width",displayWidth),displaySize.Add("height",displayHeight);for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_DISPLAYSIZECHANGE,displaySize)}}}function __SetAvailableStreams(streams){if(_s._availableStreams=streams,null!=streams)for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_AVAILABLESTREAMINFOCHANGE,streams)}}function __SendSeekEvent(type,pos){var eventAttributes=new DictionaryCS;eventAttributes.SetValue("act",type),pos>=0&&eventAttributes.SetValue("skto",pos);for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_SEND_SEEK_EVENT,eventAttributes)}}function __SetProxyInitialized(){if(!_s.isProxyInitialized){_s.isProxyInitialized=!0;for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_PROXYINITIALIZED,null)}}}function __SetNetworkInfo(networkInfo){for(var _for_array_1=_s._notifiers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var notifier=_for_array_1[_for_idx_2];_s.notifyListeners(notifier,ConvivaStreamerProxy.REASON_NETWORKINFOCHANGE,networkInfo)}}function __notifyListeners(notifier,reason,arg){try{notifier(reason,arg)}catch(e){notifier(ConvivaStreamerProxy.REASON_LOG,"ConvivaStreamerProxy : uncaught exception "+e)}}_s!=STAT_INIT&&(_s._notifiers=new ListCS),_s!=STAT_INIT&&(_s._stream=new StreamInfo(-1,ConvivaContentInfo.NO_RESOURCE,-1,-1,-1)),_s!=STAT_INIT&&(_s._playingState=ConvivaStreamerProxy.UNKNOWN),_s!=STAT_INIT&&(_s._lastMetadata=null),_s!=STAT_INIT&&(_s._lastError=null),_s!=STAT_INIT&&(_s._pendingErrors=new ListCS),_s!=STAT_INIT&&(_s._displayWidth=-1),_s!=STAT_INIT&&(_s._displayHeight=-1),_s!=STAT_INIT&&(_s._availableStreams=null),_s!=STAT_INIT&&(_s._currentLoadingStatus=null),_s!=STAT_INIT&&(_s.isProxyInitialized=void 0),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_NETWORKINFOCHANGE="NetworkInfoChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_PLAYINGSTATECHANGE="PlayingStateChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_STREAMINFOCHANGE="StreamInfoChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_AVAILABLESTREAMINFOCHANGE="AvailableStreamInfoChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_PROXYINITIALIZED="ProxyInitialized"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_METADATACHANGE="MetadataChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_LOADINGSTATUSCHANGE="LoadingStatusChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_DOWNLOADSTATECHANGE="DownloadStateChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_DISPLAYSIZECHANGE="DisplaySizeChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_ERRORCHANGE="ErrorChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_LOG="Log"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_RESOURCE_ERROR="ResourceError"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_PRESENTATION_CHANGE="PresentationChange"),_s==STAT_INIT&&(ConvivaStreamerProxy.STOPPED="STOPPED"),_s==STAT_INIT&&(ConvivaStreamerProxy.PLAYING="PLAYING"),_s==STAT_INIT&&(ConvivaStreamerProxy.BUFFERING="BUFFERING"),_s==STAT_INIT&&(ConvivaStreamerProxy.PAUSED="PAUSED"),_s==STAT_INIT&&(ConvivaStreamerProxy.NOT_MONITORED="NOT_MONITORED"),_s==STAT_INIT&&(ConvivaStreamerProxy.ERROR="ERROR"),_s==STAT_INIT&&(ConvivaStreamerProxy.UNKNOWN="UNKNOWN"),_s==STAT_INIT&&(ConvivaStreamerProxy.DOWNLOADSTATE_ACTIVE=1),_s==STAT_INIT&&(ConvivaStreamerProxy.DOWNLOADSTATE_INACTIVE=0),_s==STAT_INIT&&(ConvivaStreamerProxy.METADATA_DURATION="duration"),_s==STAT_INIT&&(ConvivaStreamerProxy.METADATA_ENCODED_FRAMERATE="framerate"),_s==STAT_INIT&&(ConvivaStreamerProxy.METADATA_STREAM_URL="streamUrl"),_s==STAT_INIT&&(ConvivaStreamerProxy.REASON_SEND_SEEK_EVENT="SendSeekEvent"),_s==STAT_INIT&&(ConvivaStreamerProxy.BOOLEAN_TRUE=1),_s==STAT_INIT&&(ConvivaStreamerProxy.BOOLEAN_FALSE=-1),_s==STAT_INIT&&(ConvivaStreamerProxy.BOOLEAN_UNAVAILABLE=0),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_VIDEO=1),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_QUALITY_METRICS=2),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_BITRATE_METRICS=4),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_BITRATE_EXTERNAL=16),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_SOURCE_HTTP=32),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_SOURCE_CHUNKED=64),_s==STAT_INIT&&(ConvivaStreamerProxy.CAPABILITY_SOURCE_STREAMING=128),defPubMeth(_s,"Cleanup",__Cleanup),defPubMeth(_s,"GetCapabilities",__GetCapabilities),defPubMeth(_s,"GetPlayheadTimeMs",__GetPlayheadTimeMs),defPubMeth(_s,"GetIsPHTAccurate",__GetIsPHTAccurate),defPubMeth(_s,"GetBufferLengthMs",__GetBufferLengthMs),defPubMeth(_s,"GetVideoBufferLengthMs",__GetVideoBufferLengthMs),defPubMeth(_s,"GetAudioBufferLengthMs",__GetAudioBufferLengthMs),defPubMeth(_s,"GetStartingBufferLengthMs",__GetStartingBufferLengthMs),defPubMeth(_s,"SetStartingBufferLengthMs",__SetStartingBufferLengthMs),defPubMeth(_s,"GetIsStartingBufferFull",__GetIsStartingBufferFull),defPubMeth(_s,"GetRenderedFrameRate",__GetRenderedFrameRate),defPubMeth(_s,"GetSourceFrameRate",__GetSourceFrameRate),defPubMeth(_s,"GetDroppedFrames",__GetDroppedFrames),defPubMeth(_s,"GetCpuPercent",__GetCpuPercent),defPubMeth(_s,"GetMemoryAvailable",__GetMemoryAvailable),defPubMeth(_s,"GetCapacityKbps",__GetCapacityKbps),defPubMeth(_s,"GetServerAddress",__GetServerAddress),defPubMeth(_s,"GetIsLive",__GetIsLive),defPubMeth(_s,"GetStreamerVersion",__GetStreamerVersion),defPubMeth(_s,"GetSignalStrength",__GetSignalStrength),defPubMeth(_s,"FetchCandidateStreams",__FetchCandidateStreams),defPubMeth(_s,"Play",__Play),defPubMeth(_s,"GetApiVersion",__GetApiVersion),_s==STAT_INIT&&(ConvivaStreamerProxy.API_VERSION=1),defPubMeth(_s,"SetMonitoringNotifier",__SetMonitoringNotifier),defPubMeth(_s,"GetLoadingStatus",__GetLoadingStatus),defPubMeth(_s,"GetPlayingState",__GetPlayingState),defPubMeth(_s,"GetBitrateKbps",__GetBitrateKbps),defPubMeth(_s,"GetResource",__GetResource),defPubMeth(_s,"GetStream",__GetStream),defPubMeth(_s,"GetStreams",__GetStreams),defPubMeth(_s,"GetLastError",__GetLastError),defPubMeth(_s,"GetLastMetadata",__GetLastMetadata),defPubMeth(_s,"GetDisplayWidth",__GetDisplayWidth),defPubMeth(_s,"GetDisplayHeight",__GetDisplayHeight),defPubMeth(_s,"GetStreamerType",__GetStreamerType),defPubMeth(_s,"GetLoadedBytes",__GetLoadedBytes),defPubMeth(_s,"SetDownloadStateChange",__SetDownloadStateChange),defPubMeth(_s,"SetStream",__SetStream),defPubMeth(_s,"SetError",__SetError),defPubMeth(_s,"SetMetadata",__SetMetadata),defPubMeth(_s,"Log",__Log),defPubMeth(_s,"LogError",__LogError),defPubMeth(_s,"GetTotalLoadedBytes",__GetTotalLoadedBytes),defPubMeth(_s,"SetLoadingStatus",__SetLoadingStatus),defPubMeth(_s,"SetPlayingState",__SetPlayingState),defPubMeth(_s,"SetBitrateKbps",__SetBitrateKbps),defPubMeth(_s,"SetResource",__SetResource),defPubMeth(_s,"SetDisplaySize",__SetDisplaySize),defPubMeth(_s,"SetAvailableStreams",__SetAvailableStreams),defPubMeth(_s,"SendSeekEvent",__SendSeekEvent),defPubMeth(_s,"SetProxyInitialized",__SetProxyInitialized),defPubMeth(_s,"SetNetworkInfo",__SetNetworkInfo),defPrivMeth(_s,"notifyListeners",__notifyListeners),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function LivePass(){var _s=this,defaultGatewayURLError=!1;function __init(customerKey){LivePass.readyState?LivePass._utils.log("LivePass.init(): already initialized."):(null==LivePass._utils&&(LivePass._utils=Utils.CreateUtils(null)),null!=customerKey&&0!=customerKey.length?LivePass._utils.runProtectedSync((function(){LivePass._settings=LivePass._utils.getSettings(),LivePass._toggleTracesUsed&&(LivePass._settings.enableLogging=LivePass._toggleTracesValue),LivePass._settings.clientInstanceId=LivePass._utils.randUInt(),LivePass._settings.customerKey=customerKey,LivePass._settings.gatewayUrl=parseUrl(LivePass._settings.gatewayUrl),defaultGatewayURLError&&LivePass._utils.log("Gateway URL should not be set to https://cws.conviva.com or http://cws.conviva.com,therefore this call ignored"),LivePass._utils.log("LivePass.init(): url="+LivePass._settings.gatewayUrl+" customerKey="+LivePass._settings.customerKey),LivePass._utils.startFetchClientId(),PlayerStates.init(),LivePass._sessionFactory=new SessionFactory,LivePass.readyState=!0,LivePass._utils.log("LivePass.init(): done."),LivePass.networkInfo=new NetworkInfo}),"LivePass.init"):LivePass._utils.err("LivePass.init(): invalid customerKey: "+customerKey))}function __initWithSettings(customerKey,settings){LivePass.readyState?LivePass._utils.log("LivePass.initWithSettings(): already initialized."):("http://cws.conviva.com"!=settings.gatewayUrl&&"https://cws.conviva.com"!=settings.gatewayUrl||(defaultGatewayURLError=!0),LivePass._utils=Utils.CreateUtils(settings),LivePass.init(customerKey))}function __cleanup(){null!=LivePass._utils&&LivePass._utils.runProtected((function(){LivePass._utils.log("LivePass.cleanup()"),null!=LivePass._sessionFactory&&LivePass._sessionFactory.cleanup(),LivePass._sessionFactory=null,LivePass._globalSessionId=-1,null!=LivePass._utils&&LivePass._utils.cleanup(),LivePass._utils=null,LivePass._settings=null}),"LivePass.cleanup"),LivePass.readyState=!1}function __createSession(streamer,contentInfo,options){return LivePass.readyState?LivePass.createSessionWithGlobal(streamer,contentInfo,options,!1,LivePass.networkInfo):(LivePass.ping("LivePass.createSession before LivePass.init"),-1)}function __createSessionWithGlobal(streamer,contentInfo,options,global,networkInfo){var sid=LivePass._sessionFactory.newSessionId();return LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.makeSession(streamer,contentInfo,options,sid,global,networkInfo)}),"LivePass.createSession"),sid}function __reportError(sessionId,errorMsg,errorSeverity){LivePass.readyState?(void 0===errorSeverity&&(errorSeverity=StreamerError.SEVERITY_FATAL),errorSeverity===StreamerError.SEVERITY_FATAL||errorSeverity===StreamerError.SEVERITY_WARNING?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.reportError(StreamerError.makeUnscopedError(errorMsg,errorSeverity))}),"LivePass.reportError"):LivePass._utils.log("LivePass.reportError(): invalid errorSeverity parameter: "+errorSeverity)):LivePass.ping("LivePass.reportError before LivePass.init")}function __setBitrate(sessionId,bitrateKbps){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.setBitrate(bitrateKbps)}),"LivePass.setBitrate"):LivePass.ping("LivePass.setBitrate before LivePass.init")}function __setCurrentStreamMetadata(sessionId,metadata){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.setCurrentStreamMetadata(metadata)}),"LivePass.setCurrentStreamMetadata"):LivePass.ping("LivePass.setCurrentStreamMetadata before LivePass.init")}function __updateContentMetadata(sessionId,metadata){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.updateContentMetadata(metadata)}),"LivePass.updateContentMetadata"):LivePass.ping("LivePass.updateContentMetadata before LivePass.init")}function __detachStreamer(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.detachStreamer()}),"LivePass.detachStreamer"):LivePass.ping("LivePass.detachStreamer before LivePass.init")}function __attachStreamer(sessionId,streamer){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.attachStreamer(streamer)}),"LivePass.attachStreamer"):LivePass.ping("LivePass.attachStreamer before LivePass.init")}function __sendSessionEvent(sessionId,eventName,eventAttributes){if(LivePass.readyState)if(null!=eventName){var eventAttrDictCS=Lang.DictionaryFromRepr(eventAttributes);LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.sendCustomEvent(eventName,eventAttrDictCS)}),"LivePass.sendSessionEvent")}else LivePass._utils.err("LivePass.sendSessionEvent call is ignored as eventName is null");else LivePass.ping("LivePass.sendSessionEvent before LivePass.init")}function __sendEvent(eventName,eventAttributes){LivePass.readyState?LivePass._utils.runProtected((function(){if(LivePass._globalSessionId<0){var cci=new ConvivaContentInfo("",new DictionaryCS);LivePass._globalSessionId=LivePass.createSessionWithGlobal(null,cci,null,!0)}LivePass.sendSessionEvent(LivePass._globalSessionId,eventName,eventAttributes)}),"LivePass.sendEvent"):LivePass.ping("LivePass.sendEvent before LivePass.init")}function __setPlayerSeekStart(sessionId,seekToPos){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.sendSeekEvent(LivePass.SEEK_ACTIONS_TYPE.SEEK_START,seekToPos)}),"LivePass.setPlayerSeekStart"):LivePass.ping("LivePass.setPlayerSeekStart before LivePass.init")}function __setPlayerSeekEnd(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.sendSeekEvent(LivePass.SEEK_ACTIONS_TYPE.SEEK_END,-1)}),"LivePass.setPlayerSeekEnd"):LivePass.ping("LivePass.setPlayerSeekEnd before LivePass.init")}function __setUserSeekButtonUp(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.sendSeekEvent(LivePass.SEEK_ACTIONS_TYPE.BUTTON_UP,-1)}),"LivePass.setUserSeekButtonUp"):LivePass.ping("LivePass.setUserSeekButtonUp before LivePass.init")}function __setUserSeekButtonDown(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.sendSeekEvent(LivePass.SEEK_ACTIONS_TYPE.BUTTON_DOWN,-1)}),"LivePass.setUserSeekButtonDown"):LivePass.ping("LivePass.setUserSeekButtonDown before LivePass.init")}function __cleanupSession(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){LivePass._sessionFactory.cleanupSession(sessionId)}),"Livepass.cleanupSession"):LivePass.ping("LivePass.cleanupSession before LivePass.init")}function __pauseJoinTime(sessionId){LivePass.readyState?LivePass.adStart(sessionId):LivePass.ping("LivePass.pauseJoinTime before LivePass.init")}function __resumeJoinTime(sessionId){LivePass.readyState?LivePass.adEnd(sessionId):LivePass.ping("LivePass.resumeJoinTime before LivePass.init")}function __adStart(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.adStart()}),"LivePass.adStart"):LivePass.ping("LivePass.adStart before LivePass.init")}function __adEnd(sessionId){LivePass.readyState?LivePass._utils.runProtected((function(){var session=LivePass._sessionFactory.getSession(sessionId);null!=session&&session.adEnd()}),"LivePass.adEnd"):LivePass.ping("LivePass.adEnd before LivePass.init")}function __toggleTraces(b){LivePass._toggleTracesUsed=!0,null!=LivePass._settings?LivePass._settings.enableLogging=b:LivePass._toggleTracesValue=b}function __setConnectionType(ct){null!=LivePass.networkInfo&&(LivePass.networkInfo.connectionType=ct,LivePass._utils.runProtected((function(){if(null!=LivePass._sessionFactory&&null!=LivePass._sessionFactory._sessionsById)for(var _for_array_1=LivePass._sessionFactory._sessionsById.KeyValuePairs,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var sessionPair,session=_for_array_1[_for_idx_2].Value;null!=session&&session.setConnectionType()}}),"LivePass.setConnectionType"))}function __setSignalStrength(ss){null!=LivePass.networkInfo&&(LivePass.networkInfo.signalStrength=ss,LivePass._utils.runProtected((function(){if(null!=LivePass._sessionFactory&&null!=LivePass._sessionFactory._sessionsById)for(var _for_array_1=LivePass._sessionFactory._sessionsById.KeyValuePairs,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var sessionPair,session=_for_array_1[_for_idx_2].Value;null!=session&&session.setSignalStrength()}}),"LivePass.setSignalStrength"))}function __setLinkEncryption(le){null!=LivePass.networkInfo&&(LivePass.networkInfo.linkEncryption=le,LivePass._utils.runProtected((function(){if(null!=LivePass._sessionFactory&&null!=LivePass._sessionFactory._sessionsById)for(var _for_array_1=LivePass._sessionFactory._sessionsById.KeyValuePairs,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var sessionPair,session=_for_array_1[_for_idx_2].Value;null!=session&&session.setLinkEncryption()}}),"LivePass.setLinkEncryption"))}function __ping(msg){null!=LivePass._utils&&LivePass._utils.ping(msg)}LivePass.SEEK_ACTIONS_TYPE={SEEK_START:"pss",SEEK_END:"pse",BUTTON_UP:"bu",BUTTON_DOWN:"bd"},_s==STAT_INIT&&(LivePass.READY="READY"),_s==STAT_INIT&&(LivePass.STREAM_SELECTION_SUCC=0),_s==STAT_INIT&&(LivePass.STREAM_SELECTION_FAILURE=1),_s==STAT_INIT&&(LivePass.STREAM_SELECTION_TIMEOUT=2),_s==STAT_INIT&&(LivePass.OPTION_EXTERNAL_BITRATE_REPORTING="externalBitrateReporting"),_s==STAT_INIT&&(LivePass.readyState=!1),_s==STAT_INIT&&(LivePass._settings=null),_s==STAT_INIT&&(LivePass._utils=null),_s==STAT_INIT&&(LivePass._sessionFactory=null),_s==STAT_INIT&&(LivePass._toggleTracesUsed=!1),_s==STAT_INIT&&(LivePass._toggleTracesValue=!1),_s==STAT_INIT&&(LivePass._globalSessionId=-1),defStatMeth(_s,LivePass,"init",__init),defStatMeth(_s,LivePass,"initWithSettings",__initWithSettings),defStatMeth(_s,LivePass,"cleanup",__cleanup),defStatMeth(_s,LivePass,"createSession",__createSession),defStatMeth(_s,LivePass,"createSessionWithGlobal",__createSessionWithGlobal),defStatMeth(_s,LivePass,"reportError",__reportError),defStatMeth(_s,LivePass,"setBitrate",__setBitrate),defStatMeth(_s,LivePass,"setCurrentStreamMetadata",__setCurrentStreamMetadata),defStatMeth(_s,LivePass,"updateContentMetadata",__updateContentMetadata),defStatMeth(_s,LivePass,"detachStreamer",__detachStreamer),defStatMeth(_s,LivePass,"attachStreamer",__attachStreamer),defStatMeth(_s,LivePass,"sendSessionEvent",__sendSessionEvent),defStatMeth(_s,LivePass,"sendEvent",__sendEvent),defStatMeth(_s,LivePass,"setPlayerSeekStart",__setPlayerSeekStart),defStatMeth(_s,LivePass,"setPlayerSeekEnd",__setPlayerSeekEnd),defStatMeth(_s,LivePass,"setUserSeekButtonUp",__setUserSeekButtonUp),defStatMeth(_s,LivePass,"setUserSeekButtonDown",__setUserSeekButtonDown),defStatMeth(_s,LivePass,"cleanupSession",__cleanupSession),defStatMeth(_s,LivePass,"pauseJoinTime",__pauseJoinTime),defStatMeth(_s,LivePass,"resumeJoinTime",__resumeJoinTime),defStatMeth(_s,LivePass,"adStart",__adStart),defStatMeth(_s,LivePass,"adEnd",__adEnd),defStatMeth(_s,LivePass,"toggleTraces",__toggleTraces),defStatMeth(_s,LivePass,"setConnectionType",__setConnectionType),defStatMeth(_s,LivePass,"setSignalStrength",__setSignalStrength),defStatMeth(_s,LivePass,"setLinkEncryption",__setLinkEncryption),defStatMeth(_s,LivePass,"ping",__ping);var parseUrl=function(url){if(Lang.isValidString(url)){var parser=url.split("://");if("cws.conviva.com"!=parser[1]&&("https"==parser[0]||"http"==parser[0]))return url}return"https://"+LivePass._settings.customerKey+".cws.conviva.com"}}function NetworkInfo(){var _s=this;function _constr(ctype,ss,le){_s.connectionType=ctype,_s.linkEncryption=le,_s.signalStrength=ss}function __GetConnectionType(){return _s.connectionType}function __GetSignalStrength(){return _s.signalStrength}function __GetLinkEncryption(){return _s.linkEncryption}_s!=STAT_INIT&&(_s.connectionType=void 0),_s!=STAT_INIT&&(_s.signalStrength=1),_s!=STAT_INIT&&(_s.linkEncryption=void 0),defPubMeth(_s,"GetConnectionType",__GetConnectionType),defPubMeth(_s,"GetSignalStrength",__GetSignalStrength),defPubMeth(_s,"GetLinkEncryption",__GetLinkEncryption),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function PlayerStates(){var _s=this;function __init(){PlayerStates.stateToInt=new DictionaryCS,PlayerStates.intToState=new DictionaryCS,PlayerStates.stateToInt.SetValue(PlayerStates.UNINITIALIZED,PlayerStates.eUninitialized),PlayerStates.intToState.SetValue(PlayerStates.eUninitialized,PlayerStates.UNINITIALIZED),PlayerStates.stateToInt.SetValue(PlayerStates.PLAYING,PlayerStates.ePlaying),PlayerStates.intToState.SetValue(PlayerStates.ePlaying,PlayerStates.PLAYING),PlayerStates.stateToInt.SetValue(PlayerStates.STOPPED,PlayerStates.eStopped),PlayerStates.intToState.SetValue(PlayerStates.eStopped,PlayerStates.STOPPED),PlayerStates.stateToInt.SetValue(PlayerStates.PAUSED,PlayerStates.ePaused),PlayerStates.intToState.SetValue(PlayerStates.ePaused,PlayerStates.PAUSED),PlayerStates.stateToInt.SetValue(PlayerStates.BUFFERING,PlayerStates.eBuffering),PlayerStates.intToState.SetValue(PlayerStates.eBuffering,PlayerStates.BUFFERING),PlayerStates.stateToInt.SetValue(PlayerStates.NOT_MONITORED,PlayerStates.eNotMonitored),PlayerStates.intToState.SetValue(PlayerStates.eNotMonitored,PlayerStates.NOT_MONITORED),PlayerStates.stateToInt.SetValue(PlayerStates.UNKNOWN,PlayerStates.eUnknown),PlayerStates.intToState.SetValue(PlayerStates.eUnknown,PlayerStates.UNKNOWN)}function __stringToInt(stateStr){return null==PlayerStates.stateToInt&&PlayerStates.init(),PlayerStates.stateToInt.ContainsKey(stateStr)?PlayerStates.stateToInt.GetValue(stateStr):PlayerStates.eUnknown}function __intToString(stateInt){return null==PlayerStates.intToState&&PlayerStates.init(),PlayerStates.intToState.ContainsKey(stateInt)?PlayerStates.intToState.GetValue(stateInt):PlayerStates.UNKNOWN}function __cleanup(){PlayerStates.stateToInt=null}_s==STAT_INIT&&(PlayerStates.stateToInt=null),_s==STAT_INIT&&(PlayerStates.intToState=null),_s==STAT_INIT&&(PlayerStates.UNINITIALIZED="UNINITIALIZED"),_s==STAT_INIT&&(PlayerStates.eUninitialized=0),_s==STAT_INIT&&(PlayerStates.PLAYING="PLAYING"),_s==STAT_INIT&&(PlayerStates.ePlaying=3),_s==STAT_INIT&&(PlayerStates.STOPPED="STOPPED"),_s==STAT_INIT&&(PlayerStates.eStopped=1),_s==STAT_INIT&&(PlayerStates.PAUSED="PAUSED"),_s==STAT_INIT&&(PlayerStates.ePaused=12),_s==STAT_INIT&&(PlayerStates.BUFFERING="BUFFERING"),_s==STAT_INIT&&(PlayerStates.eBuffering=6),_s==STAT_INIT&&(PlayerStates.NOT_MONITORED="NOT_MONITORED"),_s==STAT_INIT&&(PlayerStates.eNotMonitored=98),_s==STAT_INIT&&(PlayerStates.UNKNOWN="UNKNOWN"),_s==STAT_INIT&&(PlayerStates.eUnknown=100),defStatMeth(_s,PlayerStates,"init",__init),defStatMeth(_s,PlayerStates,"stringToInt",__stringToInt),defStatMeth(_s,PlayerStates,"intToString",__intToString),defStatMeth(_s,PlayerStates,"cleanup",__cleanup)}function StreamInfo(){var _s=this;function __get_type(){return _s.__auto_type}function __set_type(value){_s.__auto_type=value}function __get_sourceHeightPixels(){return _s.__auto_sourceHeightPixels}function __set_sourceHeightPixels(value){_s.__auto_sourceHeightPixels=value}function __get_sourceWidthPixels(){return _s.__auto_sourceWidthPixels}function __set_sourceWidthPixels(value){_s.__auto_sourceWidthPixels=value}function __get_bitrateKbps(){return _s.__auto_bitrateKbps}function __set_bitrateKbps(value){_s.__auto_bitrateKbps=value}function __get_resource(){return _s.__auto_resource}function __set_resource(value){_s.__auto_resource=value}function _constr(_bitrateKbps,_resource,type,widthPixels,heightPixels){_s.bitrateKbps=_bitrateKbps,_s.resource=_resource,_s.type=type,_s.sourceHeightPixels=heightPixels,_s.sourceWidthPixels=widthPixels}function __GetBitrateKbps(){return _s.bitrateKbps}function __GetResource(){return _s.resource}function __equals(other){return null!=other&&(_s.resource==other.resource&&_s.bitrateKbps==other.bitrateKbps&&_s.type==other.type&&_s.sourceHeightPixels==other.sourceHeightPixels&&_s.sourceWidthPixels==other.sourceWidthPixels)}function __ConstructClone(fromObj){if(null==fromObj)return null;var res=new StreamInfo(-1,null,-1,-1,-1);return res.type=slint.Cast(NativeLang.GetField("type",fromObj)),res.bitrateKbps=slint.Cast(NativeLang.GetField("bitrateKbps",fromObj)),res.resource=NativeLang.GetStringField("resource",fromObj),res.sourceHeightPixels=slint.Cast(NativeLang.GetField("sourceHeightPixels",fromObj)),res.sourceWidthPixels=slint.Cast(NativeLang.GetField("sourceWidthPixels",fromObj)),res}function __ToStr(){var typeString=null;switch(_s.type){case StreamInfo.UNKNOWN:typeString="UNKNOWN";break;case StreamInfo.VIDEO:typeString="VIDEO";break;case StreamInfo.AUDIO:typeString="AUDIO";break;case StreamInfo.TEXT:typeString="TEXT";break;case StreamInfo.RESOURCE:typeString="RESOURCE";break;default:throw new Error("Unknown stream type "+_s.type)}return"type="+typeString+", bitrateKbps="+_s.bitrateKbps+", resource="+(null!=_s.resource?_s.resource:"null")+", sourceHeightPixels="+_s.sourceHeightPixels+", sourceWidthPixels="+_s.sourceWidthPixels}_s==STAT_INIT&&(StreamInfo.UNKNOWN=-1),_s==STAT_INIT&&(StreamInfo.AUDIO=0),_s==STAT_INIT&&(StreamInfo.VIDEO=1),_s==STAT_INIT&&(StreamInfo.TEXT=2),_s==STAT_INIT&&(StreamInfo.RESOURCE=3),_s==STAT_INIT&&(StreamInfo.UNKNOWN_RESOURCE=""),_s==STAT_INIT&&(StreamInfo.MAX_BITRATE=2147483647),_s!=STAT_INIT&&(_s.__auto_type=void 0),defGet(_s,"type",__get_type),defSet(_s,"type",__set_type),_s!=STAT_INIT&&(_s.__auto_sourceHeightPixels=void 0),defGet(_s,"sourceHeightPixels",__get_sourceHeightPixels),defSet(_s,"sourceHeightPixels",__set_sourceHeightPixels),_s!=STAT_INIT&&(_s.__auto_sourceWidthPixels=void 0),defGet(_s,"sourceWidthPixels",__get_sourceWidthPixels),defSet(_s,"sourceWidthPixels",__set_sourceWidthPixels),_s!=STAT_INIT&&(_s.__auto_bitrateKbps=void 0),defGet(_s,"bitrateKbps",__get_bitrateKbps),defSet(_s,"bitrateKbps",__set_bitrateKbps),_s!=STAT_INIT&&(_s.__auto_resource=void 0),defGet(_s,"resource",__get_resource),defSet(_s,"resource",__set_resource),defPubMeth(_s,"GetBitrateKbps",__GetBitrateKbps),defPubMeth(_s,"GetResource",__GetResource),defPubMeth(_s,"equals",__equals),defStatMeth(_s,StreamInfo,"ConstructClone",__ConstructClone),defPubMeth(_s,"ToStr",__ToStr),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function StreamSwitch(){var _s=this;function __MakeSwitch(source,target,status){return new StreamSwitch(StreamSwitch.GetNextId(!1),source,target,-1,null,status)}function __MakeSwitchToStream(target,status){return new StreamSwitch(StreamSwitch.GetNextId(!1),null,target,-1,null,status)}function __Cleanup(){}function __get_id(){return _s.__auto_id}function __set_id(value){_s.__auto_id=value}function __get_timeoutMs(){return _s.__auto_timeoutMs}function __set_timeoutMs(value){_s.__auto_timeoutMs=value}function __get_sourceStream(){return _s.__auto_sourceStream}function __set_sourceStream(value){_s.__auto_sourceStream=value}function __get_targetStream(){return _s.__auto_targetStream}function __set_targetStream(value){_s.__auto_targetStream=value}function __get_mode(){return _s.__auto_mode}function __set_mode(value){_s.__auto_mode=value}function __get_status(){return _s.__auto_status}function __set_status(value){_s.__auto_status=value}function _constr(id,sourceStream,targetStream,timeoutMs,mode,status){_s.id=id,_s.sourceStream=sourceStream,_s.targetStream=targetStream,_s.timeoutMs=timeoutMs,_s.mode=mode,_s.status=status}function __CheckValidity(){if(null==_s.id)return"StreamSwitch.id is null (and must be non-null)";if(null!=_s.id&&"string"!=typeof _s.id)return"StreamSwitch.id is not a string";if(null!=_s.timeoutMs&&"number"!=typeof _s.timeoutMs)return"StreamSwitch.timeoutMs is not an int";if(null!=_s.mode&&"string"!=typeof _s.mode)return"StreamSwitch.mode is not a string";if(null!=_s.status&&"string"!=typeof _s.status)return"StreamSwitch.status is not a string";if(!(null==_s.sourceStream||_s.sourceStream instanceof CandidateStream))return"StreamSwitch.sourceStream is not a CandidateStream";if(null!=_s.targetStream&&!(_s.targetStream instanceof CandidateStream))return"StreamSwitch.targetStream is not a CandidateStream";var sourceStreamError=null!=_s.sourceStream?_s.sourceStream.CheckValidity():null;if(null!=sourceStreamError)return sourceStreamError;var targetStreamError=null!=_s.targetStream?_s.targetStream.CheckValidity():null;return null!=targetStreamError?targetStreamError:null}function __ConstructClone(fromObj){var res=new StreamSwitch(null,null,null,-1,"","");return res.id=NativeLang.GetStringField("id",fromObj),res.sourceStream=CandidateStream.ConstructClone(NativeLang.GetField("sourceStream",fromObj)),res.targetStream=CandidateStream.ConstructClone(NativeLang.GetField("targetStream",fromObj)),res.timeoutMs=slint.Cast(NativeLang.GetField("timeoutMs",fromObj)),res.mode=NativeLang.GetStringField("mode",fromObj),res.status=NativeLang.GetStringField("status",fromObj),res}function __StaticInit(){StreamSwitch._nextId=0}function __StaticCleanup(){StreamSwitch._nextId=0}function __GetNextId(useInternalNamespace){var id=StreamSwitch._nextId;return StreamSwitch._nextId+=1,useInternalNamespace?"c3."+Lang.ToString(id):Lang.ToString(id)}_s==STAT_INIT&&(StreamSwitch._nextId=0),_s==STAT_INIT&&(StreamSwitch.PENDING="PENDING"),_s==STAT_INIT&&(StreamSwitch.IN_PROGRESS="IN_PROGRESS"),_s==STAT_INIT&&(StreamSwitch.SUCCEEDED="SUCCEEDED"),_s==STAT_INIT&&(StreamSwitch.FAILED="FAILED"),_s==STAT_INIT&&(StreamSwitch.INTERRUPTED="INTERRUPTED"),defStatMeth(_s,StreamSwitch,"MakeSwitch",__MakeSwitch),defStatMeth(_s,StreamSwitch,"MakeSwitchToStream",__MakeSwitchToStream),defPubMeth(_s,"Cleanup",__Cleanup),_s!=STAT_INIT&&(_s.__auto_id=void 0),defGet(_s,"id",__get_id),defSet(_s,"id",__set_id),_s!=STAT_INIT&&(_s.__auto_timeoutMs=void 0),defGet(_s,"timeoutMs",__get_timeoutMs),defSet(_s,"timeoutMs",__set_timeoutMs),_s!=STAT_INIT&&(_s.__auto_sourceStream=void 0),defGet(_s,"sourceStream",__get_sourceStream),defSet(_s,"sourceStream",__set_sourceStream),_s!=STAT_INIT&&(_s.__auto_targetStream=void 0),defGet(_s,"targetStream",__get_targetStream),defSet(_s,"targetStream",__set_targetStream),_s!=STAT_INIT&&(_s.__auto_mode=void 0),defGet(_s,"mode",__get_mode),defSet(_s,"mode",__set_mode),_s!=STAT_INIT&&(_s.__auto_status=void 0),defGet(_s,"status",__get_status),defSet(_s,"status",__set_status),defPubMeth(_s,"CheckValidity",__CheckValidity),defStatMeth(_s,StreamSwitch,"ConstructClone",__ConstructClone),defStatMeth(_s,StreamSwitch,"StaticInit",__StaticInit),defStatMeth(_s,StreamSwitch,"StaticCleanup",__StaticCleanup),defStatMeth(_s,StreamSwitch,"GetNextId",__GetNextId),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function StreamerError(){var _s=this;function __get_errorCode(){return _s.__auto_errorCode}function __set_errorCode(value){_s.__auto_errorCode=value}function __get_severity(){return _s.__auto_severity}function __set_severity(value){_s.__auto_severity=value}function __get_stream(){return _s.__auto_stream}function __set_stream(value){_s.__auto_stream=value}function __get_index(){return _s.__auto_index}function __set_index(value){_s.__auto_index=value}function __get_scope(){return _s.__auto_scope}function __set_scope(value){_s.__auto_scope=value}function __makeUnscopedError(errorCode,severity){return new StreamerError(errorCode,null,-1,severity,StreamerError.ERROR_SCOPE_UNKNOWN)}function __makeStreamError(errCode,severity,stream){return new StreamerError(errCode,stream,-1,severity,StreamerError.ERROR_SCOPE_STREAM)}function __makeResourceError(errCode,severity,stream){return new StreamerError(errCode,stream,-1,severity,StreamerError.ERROR_SCOPE_RESOURCE)}function __makeStreamSegmentError(errCode,severity,stream,idx){return new StreamerError(errCode,stream,idx,severity,StreamerError.ERROR_SCOPE_STREAM_SEGMENT)}function _constr(_errorCode,_stream,_index,_severity,_scope){_s.errorCode=_errorCode,_s.stream=_stream,_s.index=_index,_s.severity=_severity,_s.scope=_scope}function __ConstructClone(fromObj){if(null==fromObj)return null;var res=new StreamerError("",null,0,0,0);return res.errorCode=NativeLang.GetStringField("errorCode",fromObj),res.severity=slint.Cast(NativeLang.GetField("severity",fromObj)),res.stream=StreamInfo.ConstructClone(NativeLang.GetField("stream",fromObj)),res.scope=slint.Cast(NativeLang.GetField("scope",fromObj)),res.index=slint.Cast(NativeLang.GetField("index",fromObj)),res}function __ToStr(){return"errorCode="+(null!=_s.errorCode?_s.errorCode:"null")+", index="+_s.index+", severity="+_s.severity+", scope="+_s.scope+", stream=("+_s.stream.ToStr()+")"}_s==STAT_INIT&&(StreamerError.ERROR_SCOPE_UNKNOWN=0),_s==STAT_INIT&&(StreamerError.ERROR_SCOPE_STREAM_SEGMENT=1),_s==STAT_INIT&&(StreamerError.ERROR_SCOPE_STREAM=2),_s==STAT_INIT&&(StreamerError.ERROR_SCOPE_RESOURCE=3),_s==STAT_INIT&&(StreamerError.SEVERITY_WARNING=0),_s==STAT_INIT&&(StreamerError.SEVERITY_FATAL=1),_s!=STAT_INIT&&(_s.__auto_errorCode=void 0),defGet(_s,"errorCode",__get_errorCode),defSet(_s,"errorCode",__set_errorCode),_s!=STAT_INIT&&(_s.__auto_severity=void 0),defGet(_s,"severity",__get_severity),defSet(_s,"severity",__set_severity),_s!=STAT_INIT&&(_s.__auto_stream=void 0),defGet(_s,"stream",__get_stream),defSet(_s,"stream",__set_stream),_s!=STAT_INIT&&(_s.__auto_index=void 0),defGet(_s,"index",__get_index),defSet(_s,"index",__set_index),_s!=STAT_INIT&&(_s.__auto_scope=void 0),defGet(_s,"scope",__get_scope),defSet(_s,"scope",__set_scope),defStatMeth(_s,StreamerError,"makeUnscopedError",__makeUnscopedError),defStatMeth(_s,StreamerError,"makeStreamError",__makeStreamError),defStatMeth(_s,StreamerError,"makeResourceError",__makeResourceError),defStatMeth(_s,StreamerError,"makeStreamSegmentError",__makeStreamSegmentError),defStatMeth(_s,StreamerError,"ConstructClone",__ConstructClone),defPubMeth(_s,"ToStr",__ToStr),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function Monitor(){var _s=this;function _constr(streamer,eventQueue,contentInfo,options,sessionId,networkInfo){if(_s._eventQueue=eventQueue,_s._utils=Utils.getInstance(),_s._contentInfo=contentInfo,_s._networkInfo=networkInfo,_s._sessionId=sessionId,_s._nextHeartbeat=new DictionaryCS,_s._streamerObject=streamer,_s._startTimeMs=0,_s._lastStateUpdateTimeMs=0,_s._pauseJoinTimeStartTimeMs=0,_s._pauseJointTimeTotalMs=0,_s._joinTimeMs=-1,-1!=_s._contentInfo.encodedFps&&(_s._encodedFps=_s._contentInfo.encodedFps,_s._externalFpsReporting=!0),-1!=_s._contentInfo.duration&&(_s._contentLengthSec=_s._contentInfo.duration,_s._externalDurationReporting=!0),_s._contentInfo.streamUrl&&(_s._streamUrl=_s._contentInfo.streamUrl,_s._externalStreamUrlReporting=!0),_s._playingFpsObservationCount=0,_s._playingFpsTotal=0,_s._stopRfpsCounter=null,null!=options){var optionsDict=Lang.DictionaryFromRepr(options);optionsDict.ContainsKey(LivePass.OPTION_EXTERNAL_BITRATE_REPORTING)&&(_s._externalBitrateReporting=optionsDict.GetValue(LivePass.OPTION_EXTERNAL_BITRATE_REPORTING))}}function __start(nowMs){_s._startTimeMs=nowMs,_s._lastStateUpdateTimeMs=nowMs,_s.buildInitialStateChangeEvent(),_s.buildInitialStreamInfo(),_s.attachStreamer(_s._streamerObject),_s._streamerObject=null}function __buildInitialStateChangeEvent(){var newState=new DictionaryCS;null!=_s._contentInfo.assetName&&newState.SetValue("an",_s._contentInfo.assetName),null!=_s._contentInfo.streamUrl&&newState.SetValue("url",_s._contentInfo.streamUrl),null!=_s._contentInfo.defaultReportingResource&&newState.SetValue("rs",_s._contentInfo.defaultReportingResource);var newStrMetadataHb={};null!=_s._contentInfo.viewerId&&(newStrMetadataHb.vid=_s._contentInfo.viewerId),null!=_s._contentInfo.playerName&&(newStrMetadataHb.pn=_s._contentInfo.playerName),Lang.dictCount(newStrMetadataHb)>0&&newState.SetValue("strmetadata",newStrMetadataHb),0!=_s._contentInfo.isLive&&1!=_s._contentInfo.isLive||newState.SetValue("lv",_s._contentInfo.isLive),_s._contentInfo.duration>=0&&newState.SetValue("cl",_s._contentInfo.duration),_s._contentInfo.encodedFps>=0&&newState.SetValue("efps",_s._contentInfo.encodedFps),Lang.dictCount(_s._contentInfo.tags)>0&&newState.SetValue("tags",_s._contentInfo.tags);var data=new DictionaryCS,newStateNative=Lang.StringDictionaryToRepr(newState);data.SetValue("new",newStateNative),data.IsEmpty("new")||_s.enqueueEvent("CwsStateChangeEvent",data)}function __attachStreamer(streamerObject){if(_s._utils.logSession("Monitor.attachStreamer()",_s._sessionId),null==_s._streamer){if(null==streamerObject)return _s._utils.logSession("Monitor.attachStreamer(): received a null streamer",_s._sessionId),void _s.SetPlayingState(ConvivaStreamerProxy.NOT_MONITORED);_s._streamer=Monitor.wrapInConvivaStreamerProxy(streamerObject,_s._sessionId),_s._sessionFlags=_s._streamer.GetCapabilities(),_s._externalBitrateReporting&&(_s._sessionFlags|=ConvivaStreamerProxy.CAPABILITY_BITRATE_EXTERNAL),_s.SetPlayingState(ConvivaStreamerProxy.UNKNOWN),_s._streamer.SetMonitoringNotifier(_s.notificationFromStreamerProxy),_s._lastStateUpdateTimeMs=_s._utils.epochTimeMs(),null==_s._stopRfpsCounter&&_s.StartRfpsCounter()}else _s._utils.logSession("Monitor.attachStreamer(): detach current streamer first",_s._sessionId)}function __detachStreamer(){_s._utils.logSession("Monitor.detachStreamer()",_s._sessionId),_s.updateMetrics(),null!=_s._stopRfpsCounter&&(_s._stopRfpsCounter(),_s._stopRfpsCounter=null),null!=_s._streamer&&(_s._streamer.Cleanup(),_s.SetPlayingState(ConvivaStreamerProxy.NOT_MONITORED),_s._streamer=null)}function __pauseJoinTime(){if(_s._utils.logSession("Monitor.pauseJoinTime()",_s._sessionId),0==_s._pauseJoinTimeStartTimeMs){_s._pauseJoinTimeStartTimeMs=_s._utils.epochTimeMs();var newState=new DictionaryCS,oldState=new DictionaryCS;newState.SetValue("pj",!0),oldState.SetValue("pj",!1),_s.declareStateChange(newState,oldState)}}function __resumeJoinTime(addEvent){if(_s._utils.logSession("Monitor.resumeJoinTime()",_s._sessionId),_s._pauseJoinTimeStartTimeMs>0&&(_s._pauseJointTimeTotalMs+=_s._utils.epochTimeMs()-_s._pauseJoinTimeStartTimeMs,addEvent)){var newState=new DictionaryCS,oldState=new DictionaryCS;newState.SetValue("pj",!1),oldState.SetValue("pj",!0),_s.declareStateChange(newState,oldState)}_s._pauseJoinTimeStartTimeMs=0}function __get_streamer(){return _s._streamer}function __buildInitialStreamInfo(){var initialBitrateKbps=-1,initialResource=null;null!=_s._contentInfo&&null!=_s._contentInfo.defaultReportingResource&&(initialResource=_s._contentInfo.defaultReportingResource),_s._streamInfo=new StreamInfo(-1,initialResource,-1,-1,-1)}function __notificationFromStreamerProxy(notificationName,arg){_s._utils.runProtected((function(){switch(notificationName){case"PlayingStateChange":var newState=arg;_s.OnPlayingStateChange(newState);break;case"StreamInfoChange":var newInfo=arg;_s.SetStream(newInfo);break;case"ErrorChange":var newError=arg;_s.OnError(newError);break;case"MetadataChange":_s.OnMetadata(arg);break;case"Log":var logMsg=arg;_s._utils.logSession(logMsg,_s._sessionId);break;case"SendSeekEvent":var evt=arg;_s.OnSeekEvent(evt);break;case"DisplaySizeChange":var evt=arg;_s.OnStreamSizeChange(evt);break;case"NetworkInfoChange":var evt=arg;_s.OnNetworkInfoChange(evt)}}),"notificationFromStreamerProxy")}function __OnStreamSizeChange(size){if(size.GetValue("width")>0&&size.GetValue("width")!=_s._width||size.GetValue("height")>0&&size.GetValue("height")!=_s._height){var newState=new DictionaryCS,oldState=new DictionaryCS;size.GetValue("width")>0&&size.GetValue("width")!=_s._width&&(newState.SetValue("w",size.GetValue("width")),_s._width>0&&oldState.SetValue("w",_s._width),_s._width=size.GetValue("width")),size.GetValue("height")>0&&size.GetValue("height")!=_s._height&&(newState.SetValue("h",size.GetValue("height")),_s._height>0&&oldState.SetValue("h",_s._height),_s._height=size.GetValue("height")),_s.declareStateChange(newState,oldState)}}function __OnNetworkInfoChange(nwinfo){if(null==_s._networkInfo.connectionType&&null!=nwinfo.connectionType&&_s._connectionType!=nwinfo.connectionType||null==_s._networkInfo.linkEncryption&&null!=nwinfo.linkEncryption&&_s._linkEncryption!=nwinfo.linkEncryption){var newState=new DictionaryCS,oldState=new DictionaryCS;null!=nwinfo.connectionType&&_s._connectionType!=nwinfo.connectionType&&(newState.SetValue("ct",nwinfo.connectionType),null!=_s._connectionType&&oldState.SetValue("ct",_s._connectionType),_s._connectionType=nwinfo.connectionType),null!=nwinfo.linkEncryption&&_s._linkEncryption!=nwinfo.linkEncryption&&(newState.SetValue("le",nwinfo.linkEncryption),null!=_s._linkEncryption&&null!=_s._linkEncryption&&oldState.SetValue("le",_s._linkEncryption),_s._linkEncryption=nwinfo.linkEncryption),_s.declareStateChange(newState,oldState)}}function __OnPlayingStateChange(newPlayingState){if(_s._playingState!=newPlayingState){var hasJoined=_s._joinTimeMs>=0,newState=new DictionaryCS,oldState=new DictionaryCS;newState.SetValue("ps",PlayerStates.stringToInt(newPlayingState)),oldState.SetValue("ps",PlayerStates.stringToInt(_s._playingState)),hasJoined||newPlayingState!=ConvivaStreamerProxy.PLAYING||(_s._pauseJoinTimeStartTimeMs>0&&(_s.resumeJoinTime(!1),newState.SetValue("pj",!1),oldState.SetValue("pj",!0)),_s._joinTimeMs=slint.Cast(_s._utils.epochTimeMs()-_s._startTimeMs-_s._pauseJointTimeTotalMs),_s._joinTimeMs<0&&(_s._joinTimeMs=0)),_s._utils.logSession("Monitor: change playing state to "+newPlayingState,_s._sessionId),_s._playingState=newPlayingState,_s.declareStateChange(newState,oldState)}}function __SetPlayingState(newState){_s._playingState!=newState&&_s.OnPlayingStateChange(newState)}function __SetStream(targetStream){null!=targetStream&&(null!=_s._streamer&&(targetStream.bitrateKbps==_s._streamer.GetBitrateKbps()&&(targetStream.bitrateKbps=-2),targetStream.resource==_s._streamer.GetResource()&&(targetStream.resource=null)),(targetStream.bitrateKbps<=-2||_s._externalBitrateReporting)&&(targetStream.bitrateKbps=_s._streamInfo.bitrateKbps),null!=targetStream.resource&&targetStream.resource!=ConvivaContentInfo.NO_RESOURCE||(targetStream.resource=_s._streamInfo.resource),_s._streamInfo.equals(targetStream)||(_s.enqueueStreamChangeEvent(_s._streamInfo,targetStream),_s._streamInfo=targetStream))}function __setBitrate(newBitrateKbps){if(_s._externalBitrateReporting&&_s._streamer){var newStream=StreamInfo.ConstructClone(_s._streamInfo);newStream.bitrateKbps=newBitrateKbps,newStream.bitrateKbps!=_s._streamer.GetBitrateKbps()&&(_s.enqueueStreamChangeEvent(_s._streamInfo,newStream),_s._streamInfo=newStream)}else _s._utils.logSession("setBitrate() call ignored, enable external bitrate reporting first.",_s._sessionId)}function __OnError(e){_s.declareError(e.errorCode,e.severity==StreamerError.SEVERITY_FATAL)}function __OnMetadata(metadata){if(!_s._externalFpsReporting||!_s._externalDurationReporting||!_s._externalStreamUrlReporting){var metadataDict=Lang.DictionaryFromRepr(metadata),newState=new DictionaryCS,oldState=new DictionaryCS;metadataDict.ContainsKey(ConvivaStreamerProxy.METADATA_ENCODED_FRAMERATE)&&!_s._externalFpsReporting&&(_s._encodedFps=slint.Cast(_s._utils.parseNumber(metadataDict.GetValue(ConvivaStreamerProxy.METADATA_ENCODED_FRAMERATE),-1)),_s._utils.logSession("Monitor: received "+ConvivaStreamerProxy.METADATA_ENCODED_FRAMERATE+" metadata: "+_s._encodedFps,_s._sessionId),_s._encodedFps>0&&_s._contentInfo.encodedFps!=_s._encodedFps&&(_s._contentInfo.encodedFps>0&&oldState.SetValue("efps",_s._contentInfo.encodedFps),newState.SetValue("efps",_s._encodedFps),_s._contentInfo.encodedFps=_s._encodedFps)),metadataDict.ContainsKey(ConvivaStreamerProxy.METADATA_DURATION)&&!_s._externalDurationReporting&&(_s._contentLengthSec=slint.Cast(_s._utils.parseNumber(metadataDict.GetValue(ConvivaStreamerProxy.METADATA_DURATION),-1)),_s._utils.logSession("Monitor: received "+ConvivaStreamerProxy.METADATA_DURATION+" metadata: "+_s._contentLengthSec,_s._sessionId),_s._contentLengthSec>0&&_s._contentInfo.duration!=_s._contentLengthSec&&(_s._contentInfo.duration>0&&oldState.SetValue("cl",_s._contentInfo.duration),newState.SetValue("cl",_s._contentLengthSec),_s._contentInfo.duration=_s._contentLengthSec)),metadataDict.ContainsKey(ConvivaStreamerProxy.METADATA_STREAM_URL)&&!_s._externalStreamUrlReporting&&(_s._streamUrl=metadataDict.GetValue(ConvivaStreamerProxy.METADATA_STREAM_URL),"string"==typeof _s._streamUrl&&_s._contentInfo.streamUrl!=_s._streamUrl&&(_s._utils.logSession("Monitor: received "+ConvivaStreamerProxy.METADATA_STREAM_URL+" metadata: "+_s._streamUrl,_s._sessionId),null!=_s._contentInfo.streamUrl&&oldState.SetValue("url",_s._contentInfo.streamUrl),newState.SetValue("url",_s._streamUrl),_s._contentInfo.streamUrl=_s._streamUrl)),_s.declareStateChange(newState,oldState)}}function __OnSeekEvent(evt){_s.enqueueEvent("CwsSeekEvent",evt)}function __updateHeartbeat(heartbeat){_s.updateMetrics();var averageFps=-1;_s._playingFpsObservationCount>0&&(averageFps=slint.Cast((_s._playingFpsTotal+0)/_s._playingFpsObservationCount)),null!=_s._contentInfo.assetName&&NativeLang.setDictValue(heartbeat,"an",_s._contentInfo.assetName),NativeLang.setDictValue(heartbeat,"ps",PlayerStates.stringToInt(_s._playingState)),NativeLang.setDictValue(heartbeat,"pj",_s._pauseJoinTimeStartTimeMs>0),NativeLang.setDictValue(heartbeat,"sf",_s._sessionFlags),null!=_s._contentInfo.streamUrl&&NativeLang.setDictValue(heartbeat,"url",_s._contentInfo.streamUrl),null!=_s._contentInfo.playerName&&NativeLang.setDictValue(heartbeat,"pn",_s._contentInfo.playerName),"unknown"!=_s._contentInfo.isLive&&NativeLang.setDictValue(heartbeat,"lv",_s._contentInfo.isLive),_s._contentLengthSec>=0&&NativeLang.setDictValue(heartbeat,"cl",_s._contentLengthSec),_s._streamInfo.GetBitrateKbps()>0&&(_s._utils.logSession("_s._externalBitrateReporting :: ",+_s._externalBitrateReporting,_s._sessionId),NativeLang.setDictValue(heartbeat,"br",_s._streamInfo.GetBitrateKbps())),_s._streamInfo.GetResource()&&NativeLang.setDictValue(heartbeat,"rs",_s._streamInfo.GetResource()),_s._encodedFps>=0&&NativeLang.setDictValue(heartbeat,"efps",_s._encodedFps),averageFps>=0&&NativeLang.setDictValue(heartbeat,"afps",averageFps),_s._playingFpsTotal>0&&NativeLang.setDictValue(heartbeat,"rfpstot",_s._playingFpsTotal),_s._playingFpsObservationCount>0&&NativeLang.setDictValue(heartbeat,"rfpscnt",_s._playingFpsObservationCount),_s._width>0&&NativeLang.setDictValue(heartbeat,"w",_s._width),_s._height>0&&NativeLang.setDictValue(heartbeat,"h",_s._height),_s._networkInfo.GetConnectionType()?NativeLang.setDictValue(heartbeat,"ct",_s._networkInfo.GetConnectionType()):null!==_s._connectionType&&NativeLang.setDictValue(heartbeat,"ct",_s._connectionType),_s._networkInfo.GetSignalStrength()<=0?NativeLang.setDictValue(heartbeat,"ss",_s._networkInfo.GetSignalStrength()):null!==_s._streamer&&"function"==typeof _s._streamer.GetSignalStrength&&_s._streamer.GetSignalStrength()<=0&&NativeLang.setDictValue(heartbeat,"ss",_s._streamer.GetSignalStrength()),_s._networkInfo.GetLinkEncryption()?NativeLang.setDictValue(heartbeat,"le",_s._networkInfo.GetLinkEncryption()):null!==_s._linkEncryption&&NativeLang.setDictValue(heartbeat,"le",_s._linkEncryption),null!==_s._streamer&&"function"==typeof _s._streamer.GetPlayheadTimeMs&&_s._streamer.GetPlayheadTimeMs()>=0&&NativeLang.setDictValue(heartbeat,"pht",Math.round(_s._streamer.GetPlayheadTimeMs())),null!==_s._streamer&&"function"==typeof _s._streamer.GetBufferLengthMs&&_s._streamer.GetBufferLengthMs()>=0&&NativeLang.setDictValue(heartbeat,"bl",Math.round(_s._streamer.GetBufferLengthMs()))}function __cleanup(){null!=_s._streamer&&_s._streamer.Cleanup(),_s._streamer=null,_s._streamerObject=null,_s._eventQueue=null,_s._contentInfo=null,_s._nextHeartbeat=null,_s._streamInfo=null,_s._utils=null}function __updateMetrics(){if(null!=_s._streamer&&_s._playingState==ConvivaStreamerProxy.PLAYING){if(!_s._externalFpsReporting)var efps=_s._streamer.GetSourceFrameRate();var rfps=_s._streamer.GetRenderedFrameRate(),dfps=_s._streamer.GetDroppedFrames();efps>=0&&(_s._encodedFps=efps),rfps>=0&&(_s._renderedFps=rfps,_s._playingFpsTotal+=rfps,_s._playingFpsObservationCount++),dfps>=0&&(_s._droppedFps=dfps)}}function __buildDataSampleEvent(){var data=new DictionaryCS;_s._networkInfo.GetSignalStrength()<=0?data.SetValue("ss",_s._networkInfo.GetSignalStrength()):null!==_s._streamer&&"function"==typeof _s._streamer.GetSignalStrength&&_s._streamer.GetSignalStrength()<=0&&data.SetValue("ss",_s._streamer.GetSignalStrength()),_s.enqueueEvent("CwsDataSamplesEvent",data)}function __enqueueEvent(type,eventData){null!==_s._streamer&&"function"==typeof _s._streamer.GetPlayheadTimeMs&&_s._streamer.GetPlayheadTimeMs()>=0&&eventData.SetValue("pht",Math.round(_s._streamer.GetPlayheadTimeMs())),null!==_s._streamer&&"function"==typeof _s._streamer.GetBufferLengthMs&&_s._streamer.GetBufferLengthMs()>=0&&eventData.SetValue("bl",Math.round(_s._streamer.GetBufferLengthMs())),_s._eventQueue.enqueueEvent(type,eventData,slint.Cast(_s._utils.epochTimeMs()-_s._startTimeMs))}function __enqueueStreamChangeEvent(oldStream,newStream){var newState=new DictionaryCS,oldState=new DictionaryCS;oldStream.GetBitrateKbps()!=newStream.GetBitrateKbps()&&newStream.GetBitrateKbps()>0&&(!0===_s._externalBitrateReporting?_s._utils.logSession("Bitrate change requested from the application",_s._sessionId):_s._utils.logSession("Bitrate change requested from the Conviva Library",_s._sessionId),oldStream.GetBitrateKbps()>0&&oldState.SetValue("br",oldStream.GetBitrateKbps()),newState.SetValue("br",newStream.GetBitrateKbps()),null!=oldState?_s._utils.logSession("Monitor: change bitrate from "+oldState.GetValue("br")+" to "+newState.GetValue("br"),_s._sessionId):_s._utils.logSession("Monitor: change bitrate to "+newState.GetValue("br"),_s._sessionId)),oldStream.GetResource()!=newStream.GetResource()&&(oldStream.GetResource()>0&&oldState.SetValue("rs",oldStream.GetResource()),newState.SetValue("rs",newStream.GetResource()),null!=oldState?_s._utils.logSession("Monitor: change resource from "+oldState.GetValue("rs")+" to "+newState.GetValue("rs"),_s._sessionId):_s._utils.logSession("Monitor: change resource to "+newState.GetValue("rs"),_s._sessionId)),_s.declareStateChange(newState,oldState)}function __declareError(errorMsg,isFatal){_s._joinTimeMs<0&&isFatal&&(_s._joinTimeMs=-2);var data=new DictionaryCS;data.SetValue("ft",isFatal),null!=errorMsg?data.SetValue("err",errorMsg):data.SetValue("err",""),_s.enqueueEvent("CwsErrorEvent",data)}function __declareStateChange(newState,oldState){if(newState.Count>0){var newStateNative=Lang.StringDictionaryToRepr(newState),data=new DictionaryCS;if(data.SetValue("new",newStateNative),null!=oldState&&oldState.Count>0){var oldStateNative=Lang.StringDictionaryToRepr(oldState);data.SetValue("old",oldStateNative)}_s.enqueueEvent("CwsStateChangeEvent",data)}}function __wrapInConvivaStreamerProxy(streamer,sessionId){var realSamsungStreamerProxy=null;try{streamer.getAttribute&&streamer.getAttribute("classid").indexOf("clsid:SAMSUNG-INFOLINK")>=0&&(realSamsungStreamerProxy=new SamsungStreamerProxy(streamer)).startMonitoring()}catch(e){}return realSamsungStreamerProxy||(streamer.hasOwnProperty("getStreamerType")&&"Samsung"==streamer.getStreamerType()?SamsungStreamerProxy.createSamsungStreamerProxy(streamer):void 0!==streamer.setQosData&&void 0!==streamer.licenseResponse?new PlayStationTouchFactorStreamerProxy:void 0!==streamer.codecs&&void 0!==streamer.maxBufferLength?new PlayStationLibjscriptStreamerProxy:void 0!==streamer.textTrackDisplay&&void 0!==streamer.mediaLoader?new ConvivaVideojsStreamerProxy(streamer):void 0!==streamer.networkState&&void 0!==streamer.readyState?new Html5ConvivaStreamerProxy(streamer):void 0!==streamer.currentPTS&&void 0!==streamer.availableAudioStreams?new PlayStationTrilithiumStreamerProxy(streamer):void 0!==streamer.mediaElementAdapter?new Xbox1ConvivaStreamerProxy(streamer):void 0!==streamer.MbId&&void 0!==streamer.blockedParams?new ConvivaOoyalaStreamerProxy(streamer):void 0!==streamer.mb&&void 0!==streamer.mb.MbId&&void 0!==streamer.mb.blockedParams?new ConvivaOoyalaStreamerProxy(streamer.mb):streamer)}function __updateConnectionType(){if(null!=_s._networkInfo&&null!=_s._networkInfo.connectionType&&_s._connectionType!=_s._networkInfo.connectionType){var newState=new DictionaryCS,oldState=null,oldState;if(newState.SetValue("ct",_s._networkInfo.connectionType),null!=_s._connectionType)(oldState=new DictionaryCS).SetValue("ct",_s._connectionType);_s._connectionType=_s._networkInfo.connectionType,_s.declareStateChange(newState,oldState)}}function __updateSignalStrength(){null!=_s._networkInfo&&_s._networkInfo.signalStrength<=0&&_s._signalStrength!=_s._networkInfo.signalStrength&&(_s.buildDataSampleEvent(),_s._signalStrength=_s._networkInfo.signalStrength)}function __updateLinkEncryption(){if(null!=_s._networkInfo&&null!=_s._networkInfo.linkEncryption&&_s._linkEncryption!=_s._networkInfo.linkEncryption){var newState=new DictionaryCS,oldState=null,oldState;if(newState.SetValue("le",_s._networkInfo.linkEncryption),null!=_s._linkEncryption)(oldState=new DictionaryCS).SetValue("le",_s._linkEncryption);_s._linkEncryption=_s._networkInfo.linkEncryption,_s.declareStateChange(newState,oldState)}}function __startRfpsCounter(){_s._stopRfpsCounter=_s._utils._settings.platformApi.createTimer(_s.RfpsCounter,1e3,"Monitor.RfpsCounter")}function __rfpsCounter(){if(null!=_s._streamer&&_s._playingState==ConvivaStreamerProxy.PLAYING){var rfps=_s._streamer.GetRenderedFrameRate();rfps>=0&&(_s._renderedFps=rfps,_s._playingFpsTotal+=rfps,_s._playingFpsObservationCount++)}}_s!=STAT_INIT&&(_s._sessionId=0),_s!=STAT_INIT&&(_s._externalBitrateReporting=!1),_s!=STAT_INIT&&(_s._streamer=null),_s!=STAT_INIT&&(_s._streamerObject=null),_s!=STAT_INIT&&(_s._eventQueue=null),_s!=STAT_INIT&&(_s._contentInfo=null),_s!=STAT_INIT&&(_s._nextHeartbeat=null),_s!=STAT_INIT&&(_s._utils=null),_s!=STAT_INIT&&(_s._playingState=ConvivaStreamerProxy.UNKNOWN),_s!=STAT_INIT&&(_s._streamInfo=null),_s!=STAT_INIT&&(_s._sessionFlags=1),_s!=STAT_INIT&&(_s._startTimeMs=0),_s!=STAT_INIT&&(_s._lastStateUpdateTimeMs=0),_s!=STAT_INIT&&(_s._pauseJoinTimeStartTimeMs=0),_s!=STAT_INIT&&(_s._pauseJointTimeTotalMs=0),_s!=STAT_INIT&&(_s._joinTimeMs=-1),_s!=STAT_INIT&&(_s._encodedFps=-1),_s!=STAT_INIT&&(_s._contentLengthSec=-1),_s!=STAT_INIT&&(_s._streamUrl=null),_s!=STAT_INIT&&(_s._externalDurationReporting=!1),_s!=STAT_INIT&&(_s._externalStreamUrlReporting=!1),_s!=STAT_INIT&&(_s._externalFpsReporting=!1),_s!=STAT_INIT&&(_s._playingFpsObservationCount=0),_s!=STAT_INIT&&(_s._playingFpsTotal=0),defPubMeth(_s,"start",__start),defPubMeth(_s,"buildInitialStateChangeEvent",__buildInitialStateChangeEvent),defPubMeth(_s,"attachStreamer",__attachStreamer),defPubMeth(_s,"detachStreamer",__detachStreamer),defPubMeth(_s,"pauseJoinTime",__pauseJoinTime),defPubMeth(_s,"resumeJoinTime",__resumeJoinTime),defGet(_s,"streamer",__get_streamer),defPrivMeth(_s,"buildInitialStreamInfo",__buildInitialStreamInfo),defPrivMeth(_s,"notificationFromStreamerProxy",__notificationFromStreamerProxy),defPrivMeth(_s,"OnStreamSizeChange",__OnStreamSizeChange),defPrivMeth(_s,"OnNetworkInfoChange",__OnNetworkInfoChange),defPrivMeth(_s,"OnPlayingStateChange",__OnPlayingStateChange),defPrivMeth(_s,"SetPlayingState",__SetPlayingState),defPubMeth(_s,"SetStream",__SetStream),defPubMeth(_s,"setBitrate",__setBitrate),defPubMeth(_s,"OnError",__OnError),defPrivMeth(_s,"OnMetadata",__OnMetadata),defPubMeth(_s,"OnSeekEvent",__OnSeekEvent),defPubMeth(_s,"updateHeartbeat",__updateHeartbeat),defPubMeth(_s,"cleanup",__cleanup),defPrivMeth(_s,"updateMetrics",__updateMetrics),defPrivMeth(_s,"buildDataSampleEvent",__buildDataSampleEvent),defPrivMeth(_s,"enqueueEvent",__enqueueEvent),defPrivMeth(_s,"enqueueStreamChangeEvent",__enqueueStreamChangeEvent),defPrivMeth(_s,"declareError",__declareError),defPrivMeth(_s,"declareStateChange",__declareStateChange),defStatMeth(_s,Monitor,"wrapInConvivaStreamerProxy",__wrapInConvivaStreamerProxy),defPubMeth(_s,"UpdateConnectionType",__updateConnectionType),defPubMeth(_s,"UpdateSignalStrength",__updateSignalStrength),defPubMeth(_s,"UpdateLinkEncryption",__updateLinkEncryption),defPrivMeth(_s,"StartRfpsCounter",__startRfpsCounter),defPrivMeth(_s,"RfpsCounter",__rfpsCounter),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function EventQueue(){var _s=this;function _constr(){_s._events=NativeLang.makeList()}function __enqueueEvent(type,data,timeSinceSessionStart){data.SetValue("t",type),data.SetValue("st",timeSinceSessionStart),data.SetValue("seq",_s._nextSeqNumber),_s._nextSeqNumber++,NativeLang.addListValue(_s._events,Lang.StringDictionaryToRepr(data))}function __flushEvents(){var currentEvents=_s._events;return _s._events=NativeLang.makeList(),currentEvents}_s!=STAT_INIT&&(_s._events=null),_s!=STAT_INIT&&(_s._nextSeqNumber=0),defPubMeth(_s,"enqueueEvent",__enqueueEvent),defPubMeth(_s,"flushEvents",__flushEvents),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function Session(){var _s=this;function _constr(streamer,contentInfo,options,global,networkInfo){_s._contentInfo=contentInfo,_s._networkInfo=networkInfo,_s._utils=Utils.getInstance(),_s._settings=_s._utils.getSettings(),_s._heartbeatIntervalMs=_s._settings.heartbeatIntervalMs,_s._gatewayUrl=_s._settings.gatewayUrl,_s._sessionId=_s._utils.randInt();for(var langTags=Lang.DictionaryFromRepr(_s._contentInfo.tags),keysToCorrect=new ListCS,_for_array_1=langTags.Keys,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var tkey=_for_array_1[_for_idx_2];null==langTags.GetValue(tkey)&&keysToCorrect.Add(tkey)}for(var _for_array_3=keysToCorrect.Values,_for_idx_4=0;_for_idx_4<_for_array_3.length;_for_idx_4++){var tkey1=_for_array_3[_for_idx_4];_s.log("WARNING: correcting null value for tag "+tkey1),NativeLang.setDictValue(_s._contentInfo.tags,tkey1,"null")}_s._nativeReprTags=Lang.StringDictionaryToRepr(_s._contentInfo.tags),_s._eventQueue=new EventQueue,global||(_s._streamer=streamer,_s._monitor=new Monitor(streamer,_s._eventQueue,_s._contentInfo,options,_s._sessionId,_s._networkInfo))}function __start(){null!=_s._monitor&&_s.log("Session.start(): assetName="+_s._contentInfo.assetName),_s._startTimeMs=_s._utils.epochTimeMs(),null!=_s._monitor&&_s._monitor.start(_s._startTimeMs),_s._heartbeatSequenceNumber=0,null==_s._utils.clientIdLoadingDone?_s.sendHeartbeat():(_s._clientIdWaiter=_s.onClientIdLoaded,_s._utils.clientIdLoadingDone.AddHandler(_s._clientIdWaiter)),_s._heartbeatTimer=null,_s.resetHeartbeatTimer()}function __cleanup(){_s.log("Session.cleanup()"+_s.sessionTypeTag()),null!=_s._heartbeatTimer&&_s._heartbeatTimer.cleanup(),_s._heartbeatTimer=null,_s._utils.logSession("Schedule the last hb before session cleanup"+_s.sessionTypeTag(),_s._sessionId),null!=_s._monitor&&_s.enqueueSessionEndEvent();var urgentHb=_s.makeHeartbeat();null!=urgentHb?_s.encodeAndPostHeartbeat(urgentHb,(function(){_s.cleanupAll()})):_s.cleanupAll()}function __enqueueSessionEndEvent(){var eventData=new DictionaryCS;_s.enqueueEvent("CwsSessionEndEvent",eventData)}function __pauseJoinTime(){null!=_s._monitor&&_s._monitor.pauseJoinTime()}function __resumeJoinTime(){null!=_s._monitor&&_s._monitor.resumeJoinTime(!0)}function __adStart(){_s.pauseJoinTime()}function __adEnd(){_s.resumeJoinTime()}function __detachStreamer(){_s._monitor.detachStreamer()}function __attachStreamer(streamer){_s._monitor.attachStreamer(streamer)}function __resetHeartbeatTimer(){null!=_s._heartbeatTimer&&_s._heartbeatTimer.cleanup(),_s._heartbeatTimer=_s._utils.createTimer(_s.sendHeartbeat,_s._heartbeatIntervalMs,"sendHeartbeat")}function __cleanupAll(){null!=_s._clientIdWaiter&&(_s._utils.clientIdLoadingDone.DeleteHandler(_s._clientIdWaiter),_s._clientIdWaiter=null),null!=_s._monitor&&(_s._monitor.cleanup(),_s._monitor=null),null!=_s._encodeHeartbeatTimer&&(_s._encodeHeartbeatTimer.cleanup(),_s._encodeHeartbeatTimer=null),null!=_s._eventQueue&&(_s._eventQueue.flushEvents(),_s._eventQueue=null),_s._contentInfo=null,_s._nativeReprTags=null,_s._settings=null,_s._utils=null}function __log(message){_s._utils.logSession(message,_s._sessionId)}function __reportError(err){_s.log("Session.reportError()"),null!=_s._monitor&&_s._monitor.OnError(err)}function __setBitrate(bitrateKbps){_s.log("Session.setBitrate(): bitrateKbps="+bitrateKbps),null!=_s._monitor&&_s._monitor.setBitrate(bitrateKbps)}function __setCurrentStreamMetadata(metadata){_s.log("Session.setCurrentStreamMetadata()"),null!=_s._monitor&&null!=_s._monitor.streamer&&_s._monitor.streamer.SetMetadata(metadata)}function __updateContentMetadata(cci){if(null!=_s._monitor){var newState=new DictionaryCS,oldState=new DictionaryCS,oldCci={},makeStrMetadata=!1;if(oldCci.assetName=_s._contentInfo.assetName,oldCci.streamUrl=_s._contentInfo.streamUrl,oldCci.defaultReportingResource=_s._contentInfo.defaultReportingResource,oldCci.viewerId=_s._contentInfo.viewerId,oldCci.playerName=_s._contentInfo.playerName,oldCci.isLive=_s._contentInfo.isLive,oldCci.duration=_s._contentInfo.duration,oldCci.encodedFps=_s._contentInfo.encodedFps,null!=cci.assetName&&oldCci.assetName!=cci.assetName&&(null!=oldCci.assetName&&oldState.SetValue("an",oldCci.assetName),newState.SetValue("an",cci.assetName),_s._contentInfo.assetName=cci.assetName),null!=cci.streamUrl&&oldCci.streamUrl!=cci.streamUrl&&(null!=oldCci.streamUrl&&oldState.SetValue("url",oldCci.streamUrl),newState.SetValue("url",cci.streamUrl),_s._contentInfo.streamUrl=cci.streamUrl,_s._monitor._externalStreamUrlReporting=!0),null!=cci.defaultReportingResource&&oldCci.defaultReportingResource!=cci.defaultReportingResource){var newStream=new StreamInfo(-2,cci.defaultReportingResource,-1,-1,-1);null!=oldCci.defaultReportingResource&&oldState.SetValue("rs",oldCci.defaultReportingResource),newState.SetValue("rs",cci.defaultReportingResource),_s._contentInfo.defaultReportingResource=cci.defaultReportingResource,_s._monitor._streamInfo.resource=newStream.resource}var oldStrMetadataHb={},newStrMetadataHb={};if(null!=cci.viewerId&&oldCci.viewerId!=cci.viewerId&&(null!=oldCci.viewerId&&(oldStrMetadataHb.vid=oldCci.viewerId),newStrMetadataHb.vid=cci.viewerId,_s._contentInfo.viewerId=cci.viewerId),null!=cci.playerName&&oldCci.playerName!=cci.playerName&&(null!=oldCci.playerName&&(oldStrMetadataHb.pn=oldCci.playerName),newStrMetadataHb.pn=cci.playerName,_s._contentInfo.playerName=cci.playerName),Lang.dictCount(newStrMetadataHb)>0&&(Lang.dictCount(oldStrMetadataHb)>0&&oldState.SetValue("strmetadata",oldStrMetadataHb),newState.SetValue("strmetadata",newStrMetadataHb)),"unknown"!=cci.isLive&&oldCci.isLive!=cci.isLive&&("unknown"!=oldCci.isLive&&oldState.SetValue("lv",oldCci.isLive),newState.SetValue("lv",cci.isLive),_s._contentInfo.isLive=cci.isLive),-1==cci.duration&&-1==cci.encodedFps||(oldCci.duration!=cci.duration&&-1!=cci.duration&&(oldCci.duration>-1&&oldState.SetValue("cl",oldCci.duration),newState.SetValue("cl",cci.duration),_s._contentInfo.duration=cci.duration,_s._monitor._contentLengthSec=slint.Cast(_s._utils.parseNumber(cci.duration,-1)),_s._monitor._externalDurationReporting=!0),oldCci.encodedFps!=cci.encodedFps&&-1!=cci.encodedFps&&(oldCci.encodedFps>-1&&oldState.SetValue("efps",oldCci.encodedFps),newState.SetValue("efps",cci.encodedFps),_s._contentInfo.encodedFps=cci.encodedFps,_s._monitor._encodedFps=slint.Cast(_s._utils.parseNumber(cci.encodedFps,-1)),_s._monitor._externalFpsReporting=!0)),cci.tags){for(var langTags=Lang.DictionaryFromRepr(cci.tags),keysToCorrect=new ListCS,_for_array_1=langTags.Keys,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var tkey=_for_array_1[_for_idx_2];null==langTags.GetValue(tkey)&&keysToCorrect.Add(tkey)}for(var _for_array_3=keysToCorrect.Values,_for_idx_4=0;_for_idx_4<_for_array_3.length;_for_idx_4++){var tkey1=_for_array_3[_for_idx_4];_s.log("WARNING: correcting null value for tag "+tkey1),NativeLang.setDictValue(cci.tags,tkey1,"null")}var keysToCheck=(langTags=Lang.DictionaryFromRepr(cci.tags)).Keys,valuesToCheck=langTags.Values;oldCci.tags={};for(var keyIndex=0;keyIndex<keysToCheck.length;keyIndex++){var tagKey=keysToCheck[keyIndex];null!=_s._contentInfo.tags[tagKey]&&_s._contentInfo.tags[tagKey]!=valuesToCheck[keyIndex]?(oldCci.tags[tagKey]=_s._contentInfo.tags[tagKey],_s._contentInfo.tags[tagKey]=valuesToCheck[keyIndex]):null==_s._contentInfo.tags[tagKey]?_s._contentInfo.tags[tagKey]=valuesToCheck[keyIndex]:null!=_s._contentInfo.tags[tagKey]&&_s._contentInfo.tags[tagKey]==valuesToCheck[keyIndex]&&delete cci.tags[tagKey]}"{}"!=JSON.stringify(oldCci.tags)&&oldState.SetValue("tags",oldCci.tags),"{}"!=JSON.stringify(cci.tags)&&newState.SetValue("tags",cci.tags)}var data=new DictionaryCS,newStateNative=Lang.StringDictionaryToRepr(newState),oldStateNative=Lang.StringDictionaryToRepr(oldState);data.SetValue("new",newStateNative),"{}"!=JSON.stringify(oldStateNative)&&data.SetValue("old",oldStateNative),data.IsEmpty("old")&&data.IsEmpty("new")||(_s.log("Session.updateContentMetadata()"),_s.enqueueEvent("CwsStateChangeEvent",data),_s._monitor._contentInfo=_s._contentInfo)}}function __sendSeekEvent(actType,seekToPos){if(null!=_s._monitor){_s.log("Session.sendSeekEvent()");var eventData=new DictionaryCS;eventData.SetValue("act",actType),seekToPos>=0&&eventData.SetValue("skto",seekToPos),_s._monitor.OnSeekEvent(eventData)}}function __sendCustomEvent(name,eventAttrs){_s.log("Session.sendEvent(): eventName="+name+_s.sessionTypeTag());var eventData=new DictionaryCS;eventData.SetValue("name",name);var eventAttrsNative=Lang.StringDictionaryToRepr(eventAttrs);Lang.dictCount(eventAttrsNative)>0&&eventData.SetValue("attr",eventAttrsNative),_s.enqueueEvent("CwsCustomEvent",eventData)}function __enqueueEvent(type,data){null!==_s._streamer&&"function"==typeof _s._streamer.GetPlayheadTimeMs&&_s._streamer.GetPlayheadTimeMs()>=0&&data.SetValue("pht",Math.round(_s._streamer.GetPlayheadTimeMs())),null!==_s._streamer&&"function"==typeof _s._streamer.GetBufferLengthMs&&_s._streamer.GetBufferLengthMs()>=0&&data.SetValue("bl",Math.round(_s._streamer.GetBufferLengthMs())),_s._eventQueue.enqueueEvent(type,data,slint.Cast(_s._utils.epochTimeMs()-_s._startTimeMs))}function __sendHeartbeat(){var heartbeat=null;null!=_s._encodeHeartbeatTimer&&_s._encodeHeartbeatTimer.cleanup(),_s._encodeHeartbeatTimer=_s._utils.scheduleAction((function(){null!=(heartbeat=_s.makeHeartbeat())&&(_s._encodeHeartbeatTimer=_s._utils.scheduleAction((function(){_s.encodeAndPostHeartbeat(heartbeat,null),_s._encodeHeartbeatTimer=null}),1,"encodeAndSendHeartbeat"))}),1,"makeHeartbeat")}function __makeHeartbeat(){var currentEvents=_s._eventQueue.flushEvents();if(null==_s._monitor&&0==NativeLang.listCount(currentEvents))return null;var heartbeat={};NativeLang.setDictValue(heartbeat,"t","CwsSessionHb"),NativeLang.listCount(currentEvents)>0&&NativeLang.setDictValue(heartbeat,"evs",currentEvents),NativeLang.setDictValue(heartbeat,"cid",_s._settings.customerKey),NativeLang.setDictValue(heartbeat,"clid",_s._utils.clientId),NativeLang.setDictValue(heartbeat,"sid",_s._sessionId),NativeLang.setDictValue(heartbeat,"seq",_s._heartbeatSequenceNumber),NativeLang.setDictValue(heartbeat,"pver",_s._settings.protocolVersion),NativeLang.setDictValue(heartbeat,"clv",_s._settings.clientVersion),NativeLang.setDictValue(heartbeat,"iid",_s._settings.clientInstanceId);var platformMetadata=Lang.StringDictionaryToRepr(_s._settings.platformApi.getPlatformMetadata());null!=platformMetadata&&(NativeLang.setDictValue(heartbeat,"pm",platformMetadata),null!=platformMetadata.fw&&NativeLang.setDictValue(heartbeat,"fw",platformMetadata.fw),null!=platformMetadata.fwv&&NativeLang.setDictValue(heartbeat,"fwv",platformMetadata.fwv),null!=platformMetadata.pt&&NativeLang.setDictValue(heartbeat,"pt",platformMetadata.pt),null!=platformMetadata.ptv&&NativeLang.setDictValue(heartbeat,"ptv",platformMetadata.ptv)),null!=_s._contentInfo.viewerId&&NativeLang.setDictValue(heartbeat,"vid",_s._contentInfo.viewerId),Lang.dictCount(_s._nativeReprTags)>0&&NativeLang.setDictValue(heartbeat,"tags",_s._nativeReprTags),NativeLang.setDictValue(heartbeat,"caps",0),Session._sendLogs&&NativeLang.setDictValue(heartbeat,"lg",Lang.ListToRepr(_s._utils.getLogs(_s._sessionId))),null!=_s._monitor?_s._monitor.updateHeartbeat(heartbeat):NativeLang.setDictValue(heartbeat,"sf",0);var currentTime=_s._utils.epochTimeMs();return NativeLang.setDictValue(heartbeat,"st",slint.Cast(currentTime-_s._startTimeMs)),NativeLang.setDictValue(heartbeat,"sst",_s._startTimeMs),_s._heartbeatSequenceNumber>0&&(_s._hbInfos.forEach(element=>{"pending"===element.err&&(element.rtt=-1)}),NativeLang.setDictValue(heartbeat,"hbinfos",_s._hbInfos),_s.log("hbinfos 1 :: "+JSON.stringify(_s._hbInfos))),_s._heartbeatSequenceNumber++,heartbeat}function __sessionTypeTag(){return null==_s._monitor?" (global session)":""}function __encodeAndPostHeartbeat(heartbeat,afterPostCbk){var jsonHeartbeat=_s._utils.jsonEncode(heartbeat),url=_s._gatewayUrl+_s._settings.gatewayPath,contentType="application/json",seq=_s._heartbeatSequenceNumber-1;_s._heartbeatSendingTime=(new Date).getTime(),_s._utils.httpRequest(!0,url,jsonHeartbeat,contentType,_s.onHeartbeatResponse),_s._hbInfos.push({err:"pending",seq:seq,rtt:_s._heartbeatSendingTime}),_s._hbInfos.length>_s._maxhbinfos&&_s._hbInfos.shift(),null!=afterPostCbk&&afterPostCbk()}function __onHeartbeatResponse(isSuccess,jsonResponse){null!=_s._utils&&_s._utils.runProtected((function(){_s._heartbeatReceivedTime=(new Date).getTime();var decodedResponse=_s._utils.jsonDecode(jsonResponse),seq=decodedResponse.GetValue("seq"),sliceIndex=-1;if(_s._hbInfos.some((element,index)=>{if(element.seq===seq)return element.rtt=_s._heartbeatReceivedTime-element.rtt,element.err="ok",sliceIndex=index,!0}),sliceIndex&&sliceIndex>-1&&_s._hbInfos.length>1&&_s._hbInfos.splice(0,sliceIndex),isSuccess)if(null!=decodedResponse){decodedResponse.ContainsKey("clid")&&_s._utils.setClientIdFromServer(Lang.ToString(decodedResponse.GetValue("clid")),!1);var cfg=decodedResponse.GetValue("cfg");if(cfg){var newSendLogs=cfg.slg&&Boolean(cfg.slg);if(newSendLogs!=Session._sendLogs&&(_s.log("Turning "+(newSendLogs?"on":"off")+" sending of logs"),Session._sendLogs=newSendLogs),cfg.hbi){var heartbeatIntervalSec=slint.Cast(cfg.hbi);1e3*heartbeatIntervalSec!=_s._heartbeatIntervalMs&&(_s.log("Received hbInterval from server "+heartbeatIntervalSec),_s._heartbeatIntervalMs=1e3*heartbeatIntervalSec,null!=_s._heartbeatTimer&&_s.resetHeartbeatTimer())}if(cfg.gw){var gatewayUrl=cfg.gw;gatewayUrl!=_s._gatewayUrl&&(_s.log("Received gatewayUrl from server "+gatewayUrl),_s._gatewayUrl=gatewayUrl)}cfg.maxhbinfos&&(_s._maxhbinfos!==cfg.maxhbinfos&&_s.log("Received maxhbinfos from server "+cfg.maxhbinfos),_s._maxhbinfos=cfg.maxhbinfos)}}else _s.log("Decoded heartbeat response is null.");else _s.log("Received no response (or a bad response) to heartbeat POST request.")}),"onHeartbeatResponse")}function __onClientIdLoaded(){_s._utils.clientIdLoadingDone.DeleteHandler(_s._clientIdWaiter),_s._clientIdWaiter=null,_s.sendHeartbeat()}function __initialResourceBitrateSelection(){var proxy=_s._monitor.streamer;throw new Error("Not implemented")}function __midStreamResourceBitrateSelection(switchTriggers){throw new Error("Not implemented")}function __setConnectionType(){null!=_s._monitor&&_s._monitor.UpdateConnectionType()}function __setSignalStrength(){null!=_s._monitor&&_s._monitor.UpdateSignalStrength()}function __setLinkEncryption(){null!=_s._monitor&&_s._monitor.UpdateLinkEncryption()}_s!=STAT_INIT&&(_s._contentInfo=null),_s!=STAT_INIT&&(_s._networkInfo=null),_s!=STAT_INIT&&(_s._nativeReprTags=null),_s!=STAT_INIT&&(_s._utils=null),_s!=STAT_INIT&&(_s._settings=null),_s!=STAT_INIT&&(_s._monitor=null),_s!=STAT_INIT&&(_s._eventQueue=null),_s!=STAT_INIT&&(_s._clientIdWaiter=null),_s!=STAT_INIT&&(_s._heartbeatTimer=null),_s!=STAT_INIT&&(_s._encodeHeartbeatTimer=null),_s==STAT_INIT&&(Session._sendLogs=!1),_s!=STAT_INIT&&(_s._sessionId=0),_s!=STAT_INIT&&(_s._startTimeMs=0),_s!=STAT_INIT&&(_s._heartbeatSequenceNumber=0),_s!=STAT_INIT&&(_s._heartbeatIntervalMs=0),_s!=STAT_INIT&&(_s._gatewayUrl=0),_s!=STAT_INIT&&(_s._heartbeatSendingTime=0),_s!=STAT_INIT&&(_s._heartbeatReceivedTime=0),_s!=STAT_INIT&&(_s._hbInfos=[]),_s!=STAT_INIT&&(_s._maxhbinfos=2),defPubMeth(_s,"start",__start),defPubMeth(_s,"cleanup",__cleanup),defPrivMeth(_s,"enqueueSessionEndEvent",__enqueueSessionEndEvent),defPubMeth(_s,"pauseJoinTime",__pauseJoinTime),defPubMeth(_s,"resumeJoinTime",__resumeJoinTime),defPubMeth(_s,"adStart",__adStart),defPubMeth(_s,"adEnd",__adEnd),defPubMeth(_s,"detachStreamer",__detachStreamer),defPubMeth(_s,"attachStreamer",__attachStreamer),defPrivMeth(_s,"resetHeartbeatTimer",__resetHeartbeatTimer),defPrivMeth(_s,"cleanupAll",__cleanupAll),defPrivMeth(_s,"log",__log),defPubMeth(_s,"reportError",__reportError),defPubMeth(_s,"setBitrate",__setBitrate),defPubMeth(_s,"setCurrentStreamMetadata",__setCurrentStreamMetadata),defPubMeth(_s,"updateContentMetadata",__updateContentMetadata),defPubMeth(_s,"sendSeekEvent",__sendSeekEvent),defPubMeth(_s,"sendCustomEvent",__sendCustomEvent),defPrivMeth(_s,"enqueueEvent",__enqueueEvent),defPrivMeth(_s,"sendHeartbeat",__sendHeartbeat),defPrivMeth(_s,"makeHeartbeat",__makeHeartbeat),defPrivMeth(_s,"sessionTypeTag",__sessionTypeTag),defPrivMeth(_s,"encodeAndPostHeartbeat",__encodeAndPostHeartbeat),defPrivMeth(_s,"onHeartbeatResponse",__onHeartbeatResponse),defPrivMeth(_s,"onClientIdLoaded",__onClientIdLoaded),defPubMeth(_s,"initialResourceBitrateSelection",__initialResourceBitrateSelection),defPubMeth(_s,"midStreamResourceBitrateSelection",__midStreamResourceBitrateSelection),defPubMeth(_s,"setConnectionType",__setConnectionType),defPubMeth(_s,"setSignalStrength",__setSignalStrength),defPubMeth(_s,"setLinkEncryption",__setLinkEncryption),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function SessionFactory(){var _s=this;function _constr(){_s._utils=Utils.getInstance(),_s._settings=_s._utils.getSettings(),_s._nextSessionId=0,_s._sessionsById=new DictionaryCS,_s.lastSessionId=0}function __cleanup(){if(_s._utils=null,_s._settings=null,null!=_s._sessionsById)for(var _for_array_1=_s._sessionsById.KeyValuePairs,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var sessionPair,sess;_for_array_1[_for_idx_2].Value.cleanup()}_s._sessionsById=null,_s._nextSessionId=0}function __newSessionId(){var sessionId=_s._nextSessionId;return _s._nextSessionId++,sessionId}function __makeSession(streamer,contentInfo,options,sessionId,global,networkInfo){var session=new Session(streamer,contentInfo,options,global,networkInfo);return _s.addSession(sessionId,session),_s.lastSessionId=sessionId,session.start(),session}function __getSession(sessionId){return _s._sessionsById.ContainsKey(sessionId)?_s._sessionsById.GetValue(sessionId):(-1==sessionId?_s._utils.err("LivePass: invalid sessionId. LivePass not properly initialized yet?"):_s._utils.err("LivePass: invalid sessionId. Did you cleanup that session previously?"),null)}function __addSession(sessionId,session){_s._sessionsById.SetValue(sessionId,session)}function __removeSession(sessionId){_s._sessionsById.Remove(sessionId)}function __cleanupSession(sessionId){var session=_s.getSession(sessionId);null!=session&&(_s.removeSession(sessionId),session.cleanup())}_s!=STAT_INIT&&(_s.lastSessionId=0),_s!=STAT_INIT&&(_s._utils=null),_s!=STAT_INIT&&(_s._settings=null),_s!=STAT_INIT&&(_s._nextSessionId=0),_s!=STAT_INIT&&(_s._sessionsById=null),defPubMeth(_s,"cleanup",__cleanup),defPubMeth(_s,"newSessionId",__newSessionId),defPubMeth(_s,"makeSession",__makeSession),defPubMeth(_s,"getSession",__getSession),defPubMeth(_s,"addSession",__addSession),defPubMeth(_s,"removeSession",__removeSession),defPubMeth(_s,"cleanupSession",__cleanupSession),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function ArrayCS(){var _s=this;function _constr(size){null==size&&(size=0),_s.arr=new Array(size)}function __Create(){for(var res=new ArrayCS,l=[],i=0;i<arguments.length;i++)l.push(arguments[i]);return res.arr=l,res}function __FromRepr(a){if(null==a)return null;var res=new ArrayCS;return res.arr=a,res}function __ToRepr(){return _s.arr}function __Length(){return _s.arr.length}function __GetValue(idx){if(idx>=_s.arr.length)throw new Error("Index out of bounds: "+idx+" (length "+_s.arr.length+")");if(idx<0)throw new Error("Index out of bounds: "+idx);return _s.arr[idx]}function __SetValue(idx,v){if(idx>=_s.arr.length)throw new Error("Index out of bounds: "+idx+" (length "+_s.arr.length+")");if(idx<0)throw new Error("Index out of bounds: "+idx);_s.arr[idx]=v}function __Values(){return _s.arr}_s!=STAT_INIT&&(_s.arr=void 0),defStatMeth(_s,ArrayCS,"Create",__Create),defStatMeth(_s,ArrayCS,"FromRepr",__FromRepr),defPubMeth(_s,"ToRepr",__ToRepr),defGet(_s,"Length",__Length),defPubMeth(_s,"GetValue",__GetValue),defPubMeth(_s,"SetValue",__SetValue),defGet(_s,"Values",__Values),_s!=STAT_INIT&&_constr.apply(this,arguments)}function Cleanable(){var _s=this;function _constr(cleanupCollection){_s._cleanupCollection=cleanupCollection,_s._id=Cleanable._nextCleanupId,Cleanable._nextCleanupId++,_s._cleanupCollection.SetValue(_s._id,_s)}function __setCleanupAction(cleanupAction){_s._cleanupAction=cleanupAction}function __cleanup(){null!=_s._cleanupAction&&_s._cleanupAction(),_s._cleanupCollection.Remove(_s._id)}function __cleanupCollection(collection){Utils.getInstance().log("cleanupCollection");for(var toClean=new ListCS,_for_array_1=collection.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var o=_for_array_1[_for_idx_2];toClean.Add(o)}for(var _for_array_3=toClean.Values,_for_idx_4=0;_for_idx_4<_for_array_3.length;_for_idx_4++){var o;(o=_for_array_3[_for_idx_4]).cleanup()}collection.Clear()}_s!=STAT_INIT&&(_s._cleanupAction=null),_s==STAT_INIT&&(Cleanable._nextCleanupId=0),_s!=STAT_INIT&&(_s._id=0),_s!=STAT_INIT&&(_s._cleanupCollection=null),defPubMeth(_s,"setCleanupAction",__setCleanupAction),defPubMeth(_s,"cleanup",__cleanup),defStatMeth(_s,Cleanable,"cleanupCollection",__cleanupCollection),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function DictionaryCS(){var _s=this;function _constr(size){_s.obj={}}function __FromRepr(o){if(null==o)return null;if(o instanceof DictionaryCS)return o;o.hasOwnProperty("ToObject")&&(o=o.ToObject());var res=new DictionaryCS;return slForEachProp(o,(function(k){res.obj[k]=o[k]})),res}function __ToObject(){return _s.obj}function __Create(){for(var res=new DictionaryCS,i=0;i+1<arguments.length;i+=2)res.obj[arguments[i]]=arguments[i+1];return res}function __CopyToObject(obj){slForEachProp(_s.obj,(function(k){obj[k]=_s.obj[k]}))}function __GetValue(key){return _s.obj[key]}function __SetValue(key,v){_s.obj[key]=v}function __Clear(){slForEachProp(_s.obj,(function(p){delete _s.obj[p]}))}function __IsEmpty(key){for(var tempkey in _s.obj[key])if(_s.obj[key].hasOwnProperty(tempkey))return!1;return!0}function __ContainsKey(key){return void 0!==_s.obj[key]}function __Contains(key){return ContainsKey(key)}function __Keys(){var res=new Array;return slForEachProp(_s.obj,(function(p){res.push(p)})),res}function __Values(){var res=new Array;return slForEachProp(_s.obj,(function(p){res.push(_s.obj[p])})),res}function __KeyValuePairs(){var res=new Array;return slForEachProp(_s.obj,(function(p){res.push(new KeyValuePairCS(p,_s.obj[p]))})),res}function __Count(){var res=0;return slForEachProp(_s.obj,(function(p){res++})),res}function __Remove(key){return!!_s.ContainsKey(key)&&(delete _s.obj[key],!0)}_s!=STAT_INIT&&(_s.obj=void 0),defStatMeth(_s,DictionaryCS,"FromRepr",__FromRepr),defPubMeth(_s,"ToObject",__ToObject),defStatMeth(_s,DictionaryCS,"Create",__Create),defPubMeth(_s,"CopyToObject",__CopyToObject),defPubMeth(_s,"GetValue",__GetValue),defPubMeth(_s,"SetValue",__SetValue),defPubMeth(_s,"Clear",__Clear),defPubMeth(_s,"IsEmpty",__IsEmpty),defPubMeth(_s,"ContainsKey",__ContainsKey),defPubMeth(_s,"Contains",__Contains),defGet(_s,"Keys",__Keys),defGet(_s,"Values",__Values),defGet(_s,"KeyValuePairs",__KeyValuePairs),defGet(_s,"Count",__Count),defPubMeth(_s,"Add",__SetValue),defPubMeth(_s,"Remove",__Remove),_s!=STAT_INIT&&_constr.apply(this,arguments)}function Eventer(){var _s=this;function _constr(){_s._handlers=new ListCS}function __Cleanup(){_s._handlers=new ListCS}function __AddHandler(handler){_s._handlers.Add(handler)}function __DeleteHandler(handler){_s._handlers.Remove(handler)}function __DispatchEvent(){for(var _for_array_1=_s._handlers.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var h;(0,_for_array_1[_for_idx_2])()}}_s!=STAT_INIT&&(_s._handlers=void 0),defPubMeth(_s,"Cleanup",__Cleanup),defPubMeth(_s,"AddHandler",__AddHandler),defPubMeth(_s,"DeleteHandler",__DeleteHandler),defPubMeth(_s,"DispatchEvent",__DispatchEvent),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function KeyValuePairCS(){var _s=this;function _constr(key,val){_s.key=key,_s.val=val}function __Key(){return _s.key}function __Value(){return _s.val}_s!=STAT_INIT&&(_s.key=void 0),_s!=STAT_INIT&&(_s.val=void 0),defGet(_s,"Key",__Key),defGet(_s,"Value",__Value),_s!=STAT_INIT&&_constr.apply(this,arguments)}function Lang(){Lang.StringIndexOf=function(s1,s2){return s1.indexOf(s2)},Lang.StringStartsWith=function(s1,s2){return 0==s1.indexOf(s2)},Lang.StringContains=function(s1,s2){return 0<=s1.indexOf(s2)},Lang.StringGetChar=function(s,where){if(where<0||where>=s.length)throw new Error("ArgumentOutOfRange");return s[where]},Lang.StringSubstring=function(str,startIndex,count){if(startIndex<0||startIndex>=str.length||null!=count&&(count<0||startIndex+count>str.length))throw new Error("ArgumentOutOfRange");return null==count?str.substr(startIndex):str.substr(startIndex,count)},Lang.StringSplit=function(s1,sep){var res=s1.split(sep);return ArrayCS.FromRepr(res)},Lang.StringEnumerator=function(s){return s.split("")},Lang.StringCompareTo=function(str1,str2){return null==str1?null==str2?0:-1:null==str2?1:str1<str2?-1:str1==str2?0:1},Lang.StringTrim=function(s){return s.replace(/^\s*/,"").replace(/\s*$/,"")},Lang.StringReplace=function(str1,strsearch,strreplace){if(null==strsearch||""==strsearch||null==strreplace)throw new Error("InvalidArgument");var searchIdx=str1.indexOf(strsearch);if(searchIdx>=0){var searchLen=strsearch.length;return str1.substr(0,searchIdx)+strreplace+Lang.StringReplace(str1.substr(searchIdx+searchLen),strsearch,strreplace)}return str1},Lang.StringLastIndexOf=function(str1,strsearch){if(null==strsearch||""==strsearch)throw new Error("InvalidArgument");return str1.lastIndexOf(strsearch)},Lang.ListFromRepr=function(a){return ListCS.FromRepr(a)},Lang.ArrayFromRepr=function(repr){return ArrayCS.FromRepr(repr)},Lang.ArrayToRepr=function(a){return null==a?null:a.ToRepr()},Lang.ListFromRepr=function(repr){return ListCS.FromRepr(repr)},Lang.ListToRepr=function(l){return null==l?null:l.ToRepr()},Lang.DictionaryFromRepr=function(repr){var tmp;return DictionaryCS.FromRepr(repr)},Lang.StringDictionaryToRepr=function(dict){return null==dict?null:dict.hasOwnProperty("ToObject")?dict.ToObject():dict},Lang.DictionaryCopyToObject=function(dict,obj){null!=dict&&dict.CopyToObject(obj)},Lang.dictCount=function(dict){var size=0,key;for(key in dict)dict.hasOwnProperty(key)&&size++;return size},Lang.StringFromRepr=function(s){return s},Lang.StringToXml=function(str){try{var xmlobject,xmlobject;return window.DOMParser?(xmlobject=(new DOMParser).parseFromString(str,"text/xml")).documentElement:((xmlobject=new ActiveXObject("Microsoft.XMLDOM")).async="false",xmlobject.loadXML(str),xmlobject.documentElement)}catch(e){return null}},Lang.XmlToString=function(oXML){try{return window.XMLSerializer?(new XMLSerializer).serializeToString(oXML):oXML.xml}catch(e){return null}},Lang.ToString=function(o){return null==o?null:"function"==typeof o.ToString?o.ToString():o.toString()},Lang.StringToLower=function(s){return s.toLowerCase()},Lang.StringToInt=function(s){return parseInt(s)},Lang.AsDouble=function(v){return v instanceof Int64?v.asNumber:v instanceof UInt64?v.asNumber:Number(v)},Lang.doubleRegex=new RegExp("^([+-]?[0-9]*\\.?[0-9]+)((e|E)[+-]?[0-9]+)?$"),Lang.parseDouble=function(v){return Lang.parseChecker(v,Lang.doubleRegex,"double"),parseFloat(v)},Lang.parseChecker=function(s,pattern,what){if(!pattern.test(s))throw new Error("Invalid string for "+what+": "+s)},Lang.isValidString=function(s){return"string"==typeof s&&""!==s}}function ListCS(){var _s=this;function _constr(){arguments.length>1?Ping.Send("Error: Instantiate ListCS with too many arguments"):0==arguments.length?ArrayCS.call(_s,0):arguments[0]instanceof Number?ArrayCS.call(_s,arguments[0]):arguments[0]instanceof Array?(ArrayCS.call(_s,arguments[0].length),_s.arr=arguments[0]):arguments[0]instanceof ArrayCS?(ArrayCS.call(_s,arguments[0].length),_s.arr=arguments[0].arr):Ping.Send("Error: Instantiate ListCS with inappropriate arguments")}function __Create(a){for(var res=new ListCS,i=0;i<arguments.length;i++)res.arr.push(arguments[i]);return res}function __FromRepr(a){if(null==a)return a;if(a instanceof ListCS)return a;var res=new ListCS;return res.arr=a,res}function __ToRepr(){return _s.arr}function __Count(){return _s.arr.length}function __Values(){return _s.arr}function __Add(e){_s.arr.push(e)}function __Clear(e){_s.arr.length=0}function __IndexOf(e){var startIndex=arguments[1];if(null==startIndex)startIndex=0;else if(startIndex<0||startIndex>=_s.arr.length)throw new Error("Starting index out of bound");for(var i=startIndex;i<_s.arr.length;i++)if(_s.arr[i]==e)return i;return-1}function __Contains(e){return _s.IndexOf(e)>=0}function __Insert(idx,e){_s.arr.splice(idx,0,e)}function __Remove(e){var idx=_s.IndexOf(e);return!(idx<0)&&(_s.RemoveAt(idx),!0)}function __RemoveRange(where,count){_s.arr.splice(where,count)}function __RemoveAt(where){_s.arr.splice(where,1)}function __GetRange(startidx,len){var res=new ListCS;return res.arr=_s.arr.slice(startidx,startidx+len),res}function __Sort(){_s.arr.sort.apply(_s.arr,arguments)}function __ToArray(){return ArrayCS.FromRepr(_s.arr.slice())}_s!=STAT_INIT&&(_s.arr=void 0),defStatMeth(_s,ListCS,"Create",__Create),defStatMeth(_s,ListCS,"FromRepr",__FromRepr),defPubMeth(_s,"ToRepr",__ToRepr),defGet(_s,"Count",__Count),defGet(_s,"Values",__Values),defPubMeth(_s,"Add",__Add),defPubMeth(_s,"Clear",__Clear),defPubMeth(_s,"IndexOf",__IndexOf),defPubMeth(_s,"Contains",__Contains),defPubMeth(_s,"Insert",__Insert),defPubMeth(_s,"Remove",__Remove),defPubMeth(_s,"RemoveRange",__RemoveRange),defPubMeth(_s,"RemoveAt",__RemoveAt),defPubMeth(_s,"GetRange",__GetRange),defPubMeth(_s,"Sort",__Sort),defPubMeth(_s,"ToArray",__ToArray),_s!=STAT_INIT&&_constr.apply(this,arguments)}function NativeLang(){var _s=this;function __setDictValue(dict,key,value){dict[key]=value}function __makeList(){return[]}function __listCount(lst){return lst.length}function __addListValue(list,value){list.push(value)}function __removeListValueAt(list,idx){list.splice(idx,1)}function __GetField(propName,obj){return obj[propName]}function __GetStringField(propName,obj){var o=NativeLang.GetField(propName,obj);return o?o.toString():null}defStatMeth(_s,NativeLang,"setDictValue",__setDictValue),defStatMeth(_s,NativeLang,"makeList",__makeList),defStatMeth(_s,NativeLang,"listCount",__listCount),defStatMeth(_s,NativeLang,"addListValue",__addListValue),defStatMeth(_s,NativeLang,"removeListValueAt",__removeListValueAt),defStatMeth(_s,NativeLang,"GetField",__GetField),defStatMeth(_s,NativeLang,"GetStringField",__GetStringField)}function Settings(){var _s=this;function __changeSettings(settings){if(null!=settings)for(var sobj=Lang.DictionaryFromRepr(settings),_for_array_1=sobj.Keys,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var key=_for_array_1[_for_idx_2],v=sobj.GetValue(key);switch(key){case"platformApi":_s.platformApi=v;break;case"gatewayUrl":_s.gatewayUrl=sobj.GetValue(key);break;case"heartbeatIntervalMs":_s.heartbeatIntervalMs=slint.Cast(sobj.GetValue(key));break;case"enableLogging":_s.enableLogging=Boolean(sobj.GetValue(key));break;case"allowUncaughtExceptions":_s.allowUncaughtExceptions=Boolean(sobj.GetValue(key));break;default:throw new Error("Unsupported settings: "+key)}}}_s!=STAT_INIT&&(_s.heartbeatIntervalMs=2e4),_s!=STAT_INIT&&(_s.customerKey=null),_s!=STAT_INIT&&(_s.gatewayUrl="https://cws.conviva.com"),_s!=STAT_INIT&&(_s.gatewayPath="/0/wsg"),_s!=STAT_INIT&&(_s.protocolVersion="2.4"),_s!=STAT_INIT&&(_s.clientVersion="2.151.0.36991"),_s!=STAT_INIT&&(_s.clientInstanceId=0),_s!=STAT_INIT&&(_s.loadDataTimeoutMs=1e4),_s!=STAT_INIT&&(_s.enableLogging=!1),_s!=STAT_INIT&&(_s.platformApi=null),_s!=STAT_INIT&&(_s.allowUncaughtExceptions=!1),_s!=STAT_INIT&&(_s.pingComponentName="jscws"),_s!=STAT_INIT&&(_s.pingUrl="https://pings.conviva.com/ping.ping"),defPubMeth(_s,"changeSettings",__changeSettings)}function Utils(){var _s=this;function _constr(settings){if(_s._settings=settings,_s._referenceCount=1,_s._pingUrl=null,_s._isSendingPing=!1,_s.protocolVersion=_s._settings.protocolVersion,_s._cleanables=new DictionaryCS,null==_s._settings.platformApi&&("undefined"!=typeof PlayStationWebmafApi?_s._settings.platformApi=new PlayStationWebmafApi:"undefined"!=typeof PlayStationTouchFactorApi?_s._settings.platformApi=new PlayStationTouchFactorApi:"undefined"!=typeof PlayStationLibjscriptApi?_s._settings.platformApi=new PlayStationLibjscriptApi:_s._settings.platformApi=new ConvivaVideojsPlatformApi),null==_s._settings.platformApi)throw new Error("PlatformApi is null");_s.device=_s._settings.platformApi.getDevice(),_s.deviceVersion=_s._settings.platformApi.getDeviceVersion(),_s.deviceType=_s._settings.platformApi.getDeviceType(),_s.os=_s._settings.platformApi.getOS(),_s.osVersion=_s._settings.platformApi.getOSVersion(),_s.platform="Js"}function __CreateUtils(settings){if(null==Utils._instance){var s=new Settings;s.changeSettings(settings),Utils._instance=new Utils(s),Utils._instance._start()}else Utils._instance.getSettings().changeSettings(settings),Utils._instance._referenceCount++;return Utils._instance}function __getInstance(){if(null==Utils._instance)throw new Error("CreateUtils module has not been called");return Utils._instance}function __getPlatformApi(){return _s._settings.platformApi}function __getSettings(){return _s._settings}function ___start(){}function __cleanup(){_s._referenceCount--,_s._referenceCount>0||(null!=_s.clientIdLoadingDone&&(_s.clientIdLoadingDone.Cleanup(),_s.clientIdLoadingDone=null),null!=_s._cleanables&&(Cleanable.cleanupCollection(_s._cleanables),_s._cleanables=null),null!=_s._settings&&null!=_s._settings.platformApi&&_s._settings.platformApi.cleanup(),_s._settings=null,Utils._instance=null)}function __logNoBuffer(msg){var timeMsec,theTime=void 0;msg="["+(theTime=(_s.epochTimeMs()/1e3).toFixed(3).toString())+"] "+msg;var isError=Lang.StringContains(msg,"ERROR:");return _s._settings.enableLogging&&(isError?_s._settings.platformApi.consoleErr(msg):_s._settings.platformApi.consoleLog(msg)),msg}function __log(msg){msg=_s.logNoBuffer(msg),Utils.logBuffer.Count>=Utils.MAX_SIZE_LOGBUFFER&&Utils.logBuffer.RemoveAt(0),Utils.logBuffer.Add(msg)}function __logSession(msg,sessionId){_s.log("sid="+sessionId+" "+msg)}function __err(message){_s.log("ERROR: "+message)}function __getLogs(sessionId){var res=Utils.logBuffer;return Utils.logBuffer=new ListCS,res}function __assert(condition,msg){if(!condition)throw new Error("Assertion failure: "+msg)}function __runProtected(func,message){_s.runProtectedSync(func,message)}function __runProtectedSync(func,message){var allowUncaughtExceptions;if(_s._settings.allowUncaughtExceptions)func();else try{func()}catch(e){_s.onUncaughtException(message,e)}}function __onUncaughtException(msg,e){try{_s.ping("Uncaught exception: "+msg+": "+Lang.ToString(e))}catch(eping){_s.err("Caught exception while sending ping: "+Lang.ToString(eping))}}function __ping(msg){if(!_s._isSendingPing){_s._isSendingPing=!0,_s.initPing();var pingUrl=_s._pingUrl+"&d="+_s.urlEncodeString(Lang.ToString(msg));_s.err("Ping: "+pingUrl),_s.httpRequest(!1,pingUrl,null,null,null),_s._isSendingPing=!1}}function __initPing(){if(!_s._cachedPingUrl){var componentName="jscws",metadataSchema=null;try{var platformMetadata=Lang.DictionaryFromRepr(_s._settings.platformApi.getPlatformMetadata());null!=platformMetadata&&platformMetadata.ContainsKey("sch")&&(metadataSchema=platformMetadata.GetValue("sch"))}catch(e){}_s._pingUrl=_s._settings.pingUrl+"?comp=jscws&clv="+_s._settings.clientVersion+"&cid="+_s._settings.customerKey+"&uuid="+_s.clientId,null!=metadataSchema&&(_s._pingUrl+="&sch="+metadataSchema),_s.clientId!=Utils.DEFAULT_CLIENT_ID&&null!=metadataSchema&&(_s._cachedPingUrl=!0)}}function __urlEncodeString(rawString){return escape(rawString)}function __epochTimeMs(){return _s._settings.platformApi.epochTimeMs()}function __createTimer(timerAction,intervalMs,actionName){var cleanable=new Cleanable(_s._cleanables),wrappedAction=null;return wrappedAction=function(){_s.runProtected(timerAction,actionName)},cleanable.setCleanupAction(_s._settings.platformApi.createTimer(wrappedAction,intervalMs,actionName)),cleanable}function __scheduleAction(action,delayMs,actionName){var cleanable=new Cleanable(_s._cleanables),actionHappened=!1,wrappedAction=null;return wrappedAction=function(){null!=cleanable&&cleanable.cleanup(),action(),actionHappened=!0},cleanable.setCleanupAction(_s._settings.platformApi.createTimer(wrappedAction,delayMs,actionName)),actionHappened&&cleanable.cleanup(),cleanable}function __parseInt(decimalInt,defaultResult){var result=defaultResult;try{result=slint.Parse(decimalInt)}catch(e){}return result}function __parseNumber(numberStr,defaultResult){var result=defaultResult;try{result=Lang.parseDouble(numberStr)}catch(e){}return result}function __startFetchClientId(){_s.clientId=Utils.DEFAULT_CLIENT_ID,_s.clientIdLoadingDone=new Eventer,_s._loadClientIdTimeout=_s.scheduleAction((function(){_s.log("Timeout in reading clientId. Using "+Utils.DEFAULT_CLIENT_ID+"."),_s.ping("Timeout in reading clientId. IGNORE waited "+_s._settings.loadDataTimeoutMs+"ms."),null!=_s.clientIdLoadingDone&&_s.clientIdLoadingDone.DispatchEvent(),_s._loadClientIdTimeout=null}),_s._settings.loadDataTimeoutMs,"utils.readClientId timeout callback");var onLoad=void 0;onLoad=function(fSuccess,loadedData){_s.runProtected((function(){null!=_s._loadClientIdTimeout&&(_s._loadClientIdTimeout.cleanup(),_s._loadClientIdTimeout=null);var result=null;if(fSuccess)try{result=_s.jsonDecode(loadedData)}catch(e){result=null}var loadedClientId=null;fSuccess&&null!=result&&result.ContainsKey("clId")&&(loadedClientId=result.GetValue("clId")),null!=loadedClientId&&loadedClientId!=Utils.DEFAULT_CLIENT_ID&&"null"!=loadedClientId?(_s.clientId=loadedClientId,_s.log("Setting the client id to "+loadedClientId+" (from local storage)")):_s.log("Failed to load the client id from local storage"),null!=_s.clientIdLoadingDone&&(_s.clientIdLoadingDone.DispatchEvent(),_s.clientIdLoadingDone=null)}),"utils.fetchClientId onLoad")},_s._settings.platformApi.loadLocalData(onLoad)}function __setClientIdFromServer(newClientId,fromStorage){null!=_s._loadClientIdTimeout&&(_s._loadClientIdTimeout.cleanup(),_s._loadClientIdTimeout=null),_s.clientIdLoadingDone=null,_s.clientId!=newClientId&&(_s.clientId=newClientId,_s.log("Setting the client id to "+newClientId+" (from server)"),_s.writeClientId())}function __writeClientId(){var dataToSave=new DictionaryCS;dataToSave.SetValue("clId",_s.clientId);var onSaved=void 0;onSaved=function(fSuccess){_s.runProtected((function(){fSuccess||_s.err("An error occurred while saving the clientId.")}),"utils.writeClientId onSaved")};var dataObject=Lang.StringDictionaryToRepr(dataToSave),dataStr=_s.jsonEncode(dataObject);_s._settings.platformApi.saveLocalData(dataStr,onSaved)}function __randInt(){return Math.floor(4294967295*Math.random())-2147483648}function __randUInt(){var uInt=_s.randInt();return(uInt=Math.abs(uInt))<0&&(uInt=0),uInt}function __httpRequest(isPOST,url,data,contentType,callback){var cleanable=new Cleanable(_s._cleanables);return cleanable.setCleanupAction(_s._settings.platformApi.httpRequest(isPOST,url,data,contentType,(function(isSuccess,response){cleanable.cleanup(),null!=callback&&callback(isSuccess,response)}))),cleanable}function __jsonEncode(obj){var res=null;return _s.runProtectedSync((function(){res=_s._settings.platformApi.jsonEncode(obj)}),"utils.jsonEncode"),res}function __jsonDecode(json){var res=null;return _s.runProtectedSync((function(){var decodedJson=_s._settings.platformApi.jsonDecode(json);res=Lang.DictionaryFromRepr(decodedJson)}),"utils.jsonDecode"),res}_s==STAT_INIT&&(Utils._instance=null),_s!=STAT_INIT&&(_s._referenceCount=0),_s!=STAT_INIT&&(_s._settings=null),_s==STAT_INIT&&(Utils.DEFAULT_CLIENT_ID="0"),_s!=STAT_INIT&&(_s._loadClientIdTimeout=null),_s!=STAT_INIT&&(_s.clientId=Utils.DEFAULT_CLIENT_ID),_s!=STAT_INIT&&(_s.clientIdLoadingDone=null),_s!=STAT_INIT&&(_s._pingUrl=null),_s!=STAT_INIT&&(_s._cachedPingUrl=!1),_s!=STAT_INIT&&(_s._isSendingPing=!1),_s!=STAT_INIT&&(_s.protocolVersion=null),_s!=STAT_INIT&&(_s.device=null),_s!=STAT_INIT&&(_s.os=null),_s!=STAT_INIT&&(_s.osVersion=null),_s!=STAT_INIT&&(_s.deviceVersion=null),_s!=STAT_INIT&&(_s.deviceType=null),_s!=STAT_INIT&&(_s.platform=null),_s!=STAT_INIT&&(_s._cleanables=null),_s==STAT_INIT&&(Utils.MAX_SIZE_LOGBUFFER=32),_s==STAT_INIT&&(Utils.logBuffer=new ListCS),defStatMeth(_s,Utils,"CreateUtils",__CreateUtils),defStatMeth(_s,Utils,"getInstance",__getInstance),defPubMeth(_s,"getPlatformApi",__getPlatformApi),defPubMeth(_s,"getSettings",__getSettings),defPrivMeth(_s,"_start",___start),defPubMeth(_s,"cleanup",__cleanup),defPubMeth(_s,"logNoBuffer",__logNoBuffer),defPubMeth(_s,"log",__log),defPubMeth(_s,"logSession",__logSession),defPubMeth(_s,"err",__err),defPubMeth(_s,"getLogs",__getLogs),defPubMeth(_s,"assert",__assert),defPubMeth(_s,"runProtected",__runProtected),defPubMeth(_s,"runProtectedSync",__runProtectedSync),defPrivMeth(_s,"onUncaughtException",__onUncaughtException),defPubMeth(_s,"ping",__ping),defPrivMeth(_s,"initPing",__initPing),defPrivMeth(_s,"urlEncodeString",__urlEncodeString),defPubMeth(_s,"epochTimeMs",__epochTimeMs),defPubMeth(_s,"createTimer",__createTimer),defPubMeth(_s,"scheduleAction",__scheduleAction),defPubMeth(_s,"parseInt",__parseInt),defPubMeth(_s,"parseNumber",__parseNumber),defPubMeth(_s,"startFetchClientId",__startFetchClientId),defPubMeth(_s,"setClientIdFromServer",__setClientIdFromServer),defPrivMeth(_s,"writeClientId",__writeClientId),defPubMeth(_s,"randInt",__randInt),defPubMeth(_s,"randUInt",__randUInt),defPubMeth(_s,"httpRequest",__httpRequest),defPubMeth(_s,"jsonEncode",__jsonEncode),defPubMeth(_s,"jsonDecode",__jsonDecode),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function DataLoader(){var _s=this;function _constr(){DataLoader.referenceCount++}function handleResp(e){try{var d=e.data;if("object"!=typeof d)return;if(void 0===d.convivaRequestId){if(void 0===d.requestId)return;d.convivaRequestId=d.requestId}var domain_callback=DataLoader.callbacks[d.convivaRequestId];if(!domain_callback)return void Utils.getInstance().log("Received response for unknown request");if(!DataLoader.TESTAPI_forTouchstone&&e.origin!=domain_callback[0])return void Utils.getInstance().log("ERROR: Bad origin:"+e.origin);delete DataLoader.callbacks[d.convivaRequestId];var bytes=d.bytes;d.post_err&&"ok"==d.post_err?domain_callback[1](!0,bytes):(Utils.getInstance().log("ERROR: Error posting to "+e.origin+" ("+bytes+")"),domain_callback[1](!1,d.post_err))}catch(e){}}_s==STAT_INIT&&(DataLoader.frameId="conviva_iframe",DataLoader.frameUrl="/cws_iframe.html",DataLoader.TESTAPI_forTouchstone=!0,DataLoader.referenceCount=0,DataLoader.nextConvivaRequestId=0,DataLoader.callbacks={},DataLoader.communicationFramesIds={},"undefined"!=typeof window&&(window.addEventListener?window.addEventListener("message",handleResp,!1):window.attachEvent&&window.attachEvent("onmessage",handleResp))),this.cleanup=function(){DataLoader.referenceCount--,0==DataLoader.referenceCount&&(DataLoader.nextConvivaRequestId=0,DataLoader.callbacks={},slForEachPropValue(DataLoader.communicationFramesIds,(function(communicationFrameId){_s.removeIFrame(communicationFrameId)})),DataLoader.communicationFramesIds={})},this.findFrameById=function(remoteFrameId){return remoteFrameId?document.getElementById(remoteFrameId):null},this.findFrameForDomain=function(forDomain){var remoteFrameId=DataLoader.communicationFramesIds[forDomain];return _s.findFrameById(remoteFrameId)},this.makeRequest=function(isPOST,url,data,contentType,callback){var m=url.match(/^(https?:\/\/[^\/]*)(\/.*)$/);if(!m)return Utils.getInstance().log("ERROR: UrlLoader: cannot parse url: "+url),null;var forDomain=m[1],remoteFrame=_s.findFrameForDomain(forDomain);if(remoteFrame&&remoteFrame.loaded){var convivaRequestId=DataLoader.nextConvivaRequestId++,method,evt={url:url,method:isPOST?"POST":"GET",data:data,contentType:contentType,requestId:convivaRequestId,convivaRequestId:convivaRequestId};DataLoader.callbacks[convivaRequestId]=[forDomain,callback],remoteFrame.contentWindow.postMessage(evt,DataLoader.TESTAPI_forTouchstone?"*":forDomain)}else remoteFrame&&!remoteFrame.loaded?setTimeout((function(){_s.makeRequest(isPOST,url,data,contentType,callback)}),500):_s.insertIFrame(forDomain,(function(){var remoteFrame=_s.findFrameForDomain(forDomain);remoteFrame&&(remoteFrame.loaded=!0,_s.makeRequest(isPOST,url,data,contentType,callback))}));return null},this.insertIFrame=function(forDomain,callback){var remoteFrame=document.createElement("iframe");remoteFrame.id="_conviva_iframe_"+forDomain+"_"+DataLoader.frameId,remoteFrame.style.height="0px",remoteFrame.style.width="0px",remoteFrame.style.top="-50px",remoteFrame.style.left="-50px",remoteFrame.style.borderWidth="0px",remoteFrame.style.display="none",remoteFrame.height=0,remoteFrame.width=0,remoteFrame.src=forDomain+DataLoader.frameUrl,remoteFrame.onload=callback,DataLoader.communicationFramesIds[forDomain]=remoteFrame.id;var body=document.body||document.getElementsByTagName("body")[0];body&&body.appendChild(remoteFrame)},this.removeIFrame=function(communicationFrameId){var remoteFrame=_s.findFrameById(communicationFrameId),body;null!=remoteFrame&&(document.body||document.getElementsByTagName("body")[0]).removeChild(remoteFrame)},_s!=STAT_INIT&&_constr.apply(_s,arguments)}function Infer(){var _s=this;function _constr(){_s.Reset()}function __Update(phtNow){var now=Utils.getInstance().epochTimeMs();return _s._lastPollTime>0&&now>_s._lastPollTime&&_s._lastPlayHeadTimeSpeeds.Insert(0,Lang.AsDouble(phtNow-_s._lastPlayHeadTime)/(now-_s._lastPollTime)),_s._lastPollTime=now,_s._lastPlayHeadTime=Lang.AsDouble(phtNow),_s._lastPlayHeadTimeSpeeds.Count>Math.max(_s.movingMinimumSamples,_s.notMovingMinimumSamples)&&_s._lastPlayHeadTimeSpeeds.RemoveAt(_s._lastPlayHeadTimeSpeeds.Count-1),_s.InferState()}function __InferState(){var inferredState=null,numPhSpeedSamples=_s._lastPlayHeadTimeSpeeds.Count;if(numPhSpeedSamples>=Math.min(_s.movingMinimumSamples,_s.notMovingMinimumSamples)){for(var avgSpeed=0,_for_array_1=_s._lastPlayHeadTimeSpeeds.Values,_for_idx_2=0;_for_idx_2<_for_array_1.length;_for_idx_2++){var phSpeed;avgSpeed+=_for_array_1[_for_idx_2]}avgSpeed/=numPhSpeedSamples,numPhSpeedSamples>=_s.movingMinimumSamples&&Math.abs(avgSpeed-_s.movingExpectedSpeed)<_s.movingSpeedTolerance&&(inferredState=Infer.MOVING_STATE),numPhSpeedSamples>=_s.notMovingMinimumSamples&&avgSpeed==_s.notMovingExpectedSpeed&&(inferredState=Infer.NOT_MOVING_STATE)}return _s.resetAfter&&null!=inferredState&&_s.Reset(),inferredState}function __Reset(){_s._lastPlayHeadTimeSpeeds=new ListCS,_s._lastPlayHeadTime=-1,_s._lastPollTime=0}_s==STAT_INIT&&(Infer.MOVING_STATE="MOVING"),_s==STAT_INIT&&(Infer.NOT_MOVING_STATE="NOT_MOVING"),_s!=STAT_INIT&&(_s.movingMinimumSamples=3),_s!=STAT_INIT&&(_s.notMovingMinimumSamples=3),_s!=STAT_INIT&&(_s.movingExpectedSpeed=1),_s!=STAT_INIT&&(_s.notMovingExpectedSpeed=0),_s!=STAT_INIT&&(_s.movingSpeedTolerance=.25),_s!=STAT_INIT&&(_s.resetAfter=!1),_s!=STAT_INIT&&(_s._lastPlayHeadTimeSpeeds=void 0),_s!=STAT_INIT&&(_s._lastPlayHeadTime=0),_s!=STAT_INIT&&(_s._lastPollTime=0),defPubMeth(_s,"Update",__Update),defPrivMeth(_s,"InferState",__InferState),defPubMeth(_s,"Reset",__Reset),_s!=STAT_INIT&&_constr.apply(_s,arguments)}function ConvivaVideojsStreamerProxy(){var _s=this;function _constr(vjsPlayer){ConvivaStreamerProxy.call(_s),_s.Log("ConvivaVideojsStreamerProxy._constr()"),_s._vjsPlayer=vjsPlayer,_s._infer=new Conviva.Infer,_s._setAllEventListeners(),_s._startPolling(),_s.firstPlay=!0,_s.videoWidth=-1,_s.videoHeight=-1,_s.tech=null;var requestTech=new Object;if(requestTech.IWillNotUseThisInPlugins=!0,_s.requestTech=requestTech,_s.tech=_s._vjsPlayer.tech(_s.requestTech),_s.tech.hls){var bandW,updatedStream=new StreamInfo(Math.round(_s.tech.hls.bandwidth/1024),null,-1,-1,-1);_s.SetStream(updatedStream)}else _s.updateBitrate()}function __SetMonitoringNotifier(notifier){_s.Log("SetMonitoringNotifier from overridden method"),_s.notifier=notifier,null==_s.notifier||_s._polling||(_s.Log("start polling to be called inside SetMonitoringNotifier method"),_s._setAllEventListeners(),_s._startPolling()),_s.super_SetMonitoringNotifier(notifier)}function __Cleanup(){_s.Log("ConvivaVideojsStreamerProxy.Cleanup()"),_s.notifier=null,_s._stopPolling(),_s._removeAllEventListeners(),_s._duration=-1,_s.super_Cleanup()}function __GetCapabilities(){return _s._capabilities}_s!=STAT_INIT&&(_s._capabilities=ConvivaStreamerProxy.CAPABILITY_VIDEO+ConvivaStreamerProxy.CAPABILITY_QUALITY_METRICS+ConvivaStreamerProxy.CAPABILITY_BITRATE_METRICS,_s._duration=-1),defPubMeth(_s,"SetMonitoringNotifier",__SetMonitoringNotifier),defPubMeth(_s,"Cleanup",__Cleanup),defPubMeth(_s,"GetCapabilities",__GetCapabilities),this.GetDuration=function(){return _s._duration},this.GetPlayheadTimeMs=function(){return 1e3*_s._vjsPlayer.currentTime()},this.SetDuration=function(duration){if(_s.GetPlayingState()==Conviva.ConvivaStreamerProxy.PLAYING&&null!=_s.notifier&&null!=_s.notifier&&isFinite(duration)&&duration>0){var durationSec=Math.floor(duration);if(_s.GetDuration()!=durationSec){_s._duration=durationSec;var meta={};meta[ConvivaStreamerProxy.METADATA_DURATION]=_s._duration,_s.SetMetadata(meta)}}},this.SetPlayheadTimeMs=function(pht){if(isFinite(pht)&&pht>=0){var phtMs=1e3*pht;_s._playheadTimeMs!=phtMs&&(_s._playheadTimeMs=phtMs),_s.InferState()}},this.SetPlayerState=function(convivaState){_s.GetPlayingState()!==convivaState&&(_s.SetPlayingState(convivaState),_s._infer.Reset())},this.updateBitrate=function(){var totalBitrate=0,audioBitrate=0,videoBitrate=0;if(_s._vjsPlayer&&_s._vjsPlayer.dash){if(_s._vjsPlayer.dash.mediaPlayer){if("function"==typeof _s._vjsPlayer.dash.mediaPlayer.getQualityFor&&"function"==typeof _s._vjsPlayer.dash.mediaPlayer.getBitrateInfoListFor){var audioQuality=_s._vjsPlayer.dash.mediaPlayer.getQualityFor("audio"),audioBitrateList=_s._vjsPlayer.dash.mediaPlayer.getBitrateInfoListFor("audio");void 0!==audioQuality&&audioBitrateList&&audioBitrateList[audioQuality]&&audioBitrateList[audioQuality].bitrate&&(audioBitrate=audioBitrateList[audioQuality].bitrate);var videoQuality=_s._vjsPlayer.dash.mediaPlayer.getQualityFor("video"),videoBitrateList=_s._vjsPlayer.dash.mediaPlayer.getBitrateInfoListFor("video");void 0!==videoQuality&&videoBitrateList&&videoBitrateList[videoQuality]&&videoBitrateList[videoQuality].bitrate&&(videoBitrate=videoBitrateList[videoQuality].bitrate),totalBitrate=audioBitrate+videoBitrate}}else _s._vjsPlayer.dash.shakaPlayer&&"function"==typeof _s._vjsPlayer.dash.shakaPlayer.getStats&&_s._vjsPlayer.dash.shakaPlayer.getStats().streamBandwidth&&(totalBitrate=_s._vjsPlayer.dash.shakaPlayer.getStats().streamBandwidth);if(totalBitrate){var updatedStream=new StreamInfo(Math.round(totalBitrate/1024),null,-1,-1,-1);_s.SetStream(updatedStream)}}},this.InferState=function(){if(_s._infer){var newState=_s._infer.Update(_s._playheadTimeMs);newState&&(newState===Conviva.Infer.MOVING_STATE&&_s.GetPlayingState()!==Conviva.ConvivaStreamerProxy.PLAYING&&(_s.Log("ConvivaVideojsStreamerProxy.InferState(): PLAYING"),_s.triggeredPlayEvent=!1,_s.SetPlayerState(Conviva.ConvivaStreamerProxy.PLAYING)),newState!==Conviva.Infer.NOT_MOVING_STATE||_s.GetPlayingState()!==Conviva.ConvivaStreamerProxy.PLAYING&&_s.GetPlayingState()!==Conviva.ConvivaStreamerProxy.UNKNOWN&&!_s.triggeredPlayEvent||(_s.Log("ConvivaVideojsStreamerProxy.InferState(): BUFFERING"),_s.triggeredPlayEvent=!1,_s.SetPlayerState(Conviva.ConvivaStreamerProxy.BUFFERING)))}},this._startPolling=function(){_s._polling=!0,_s._cancelTimer=Utils.getInstance()._settings.platformApi.createTimer(_s._poll,100,"ConvivaVideojsStreamerProxy._poll")},this._poll=function(){Utils.getInstance().runProtected((function(){_s._polling&&_s._vjsPlayer?("function"==typeof _s._vjsPlayer.currentTime&&_s.SetPlayheadTimeMs(_s._vjsPlayer.currentTime()),"function"==typeof _s._vjsPlayer.duration&&_s.SetDuration(_s._vjsPlayer.duration()),"function"==typeof _s._vjsPlayer.videoWidth&&"function"==typeof _s._vjsPlayer.videoHeight&&(_s.videoWidth==_s._vjsPlayer.videoWidth()&&_s.videoHeight==_s._vjsPlayer.videoHeight()||(_s.videoWidth=_s._vjsPlayer.videoWidth(),_s.videoHeight=_s._vjsPlayer.videoHeight(),_s.SetDisplaySize(_s.videoWidth,_s.videoHeight)))):_s.SetPlayheadTimeMs(0)}),"ConvivaVideojsStreamerProxy._poll")},this._stopPolling=function(){_s._polling&&"function"==typeof _s._cancelTimer&&(_s._cancelTimer(),_s._cancelTimer=null),_s._polling=!1},this._declareError=function(errMsg){_s.Log("ConvivaVideojsStreamerProxy._declareError: "+errMsg),_s.SetError(StreamerError.makeUnscopedError(errMsg,StreamerError.SEVERITY_FATAL))},this._setAllEventListeners=function(){_s.Log("ConvivaVideojsStreamerProxy._setAllEventListeners()"),_s._vjsPlayer&&(_s._vjsPlayer.on("ended",_s.onEnded),_s._vjsPlayer.on("loadedmetadata",_s.onLoadedMetadata),_s._vjsPlayer.on("loadstart",_s.onLoadstart),_s._vjsPlayer.on("pause",_s.onPause),_s._vjsPlayer.on("durationchange",_s.onDurationchange),_s._vjsPlayer.on("emptied",_s.onEmptied),_s._vjsPlayer.on("stalled",_s.onStalled),_s._vjsPlayer.on("waiting",_s.onWaiting),_s._vjsPlayer.on("play",_s.onPlay),_s._vjsPlayer.on("seeking",_s.onSeeking),_s._vjsPlayer.on("seeked",_s.onSeeked),_s._vjsPlayer.on("error",_s.onError),_s._vjsPlayer.on("mediachange",_s.onMediaChange),_s._vjsPlayer.on("progress",_s.onProgress))},this._removeAllEventListeners=function(){_s.Log("ConvivaVideojsStreamerProxy._removeAllEventListeners()"),_s._vjsPlayer&&(_s._vjsPlayer.off("ended",_s.onEnded),_s._vjsPlayer.off("loadedmetadata",_s.onLoadedMetadata),_s._vjsPlayer.off("loadstart",_s.onLoadstart),_s._vjsPlayer.off("pause",_s.onPause),_s._vjsPlayer.off("durationchange",_s.onDurationchange),_s._vjsPlayer.off("emptied",_s.onEmptied),_s._vjsPlayer.off("stalled",_s.onStalled),_s._vjsPlayer.off("waiting",_s.onWaiting),_s._vjsPlayer.off("play",_s.onPlay),_s._vjsPlayer.off("seeking",_s.onSeeking),_s._vjsPlayer.off("seeked",_s.onSeeked),_s._vjsPlayer.off("error",_s.onError),_s._vjsPlayer.off("mediachange",_s.onMediaChange))},this.onPause=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onPause"),_s.triggeredPlayEvent=!1,_s.SetPlayerState(Conviva.ConvivaStreamerProxy.PAUSED)}),"ConvivaVideojsStreamerProxy.onPause")},this.onLoadedMetadata=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onLoadedMetadata"),_s._vjsPlayer.duration()&&_s._vjsPlayer&&_s.SetDuration(_s._vjsPlayer.duration())}),"ConvivaVideojsStreamerProxy.onLoadedMetadata")},this.onEnded=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onEnded"),_s._vjsPlayer&&_s.SetPlayerState(Conviva.ConvivaStreamerProxy.STOPPED)}),"ConvivaVideojsStreamerProxy.onEnded")},this.onDurationchange=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onDurationchange"),_s._vjsPlayer&&_s.SetDuration(_s._vjsPlayer.duration())}),"ConvivaVideojsStreamerProxy.onDurationchange")},this.onLoadstart=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onLoadstart")}),"ConvivaVideojsStreamerProxy.onLoadstart")},this.onPlay=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onPlay"),_s.triggeredPlayEvent=!0}),"ConvivaVideojsStreamerProxy.onPlay")},this.onSeeking=function(){Utils.getInstance().runProtected((function(){_s.isSeekStarted||(_s.Log("ConvivaVideojsStreamerProxy.onSeeking"),_s.isSeekStarted=!0,_s.SendSeekEvent(Conviva.LivePass.SEEK_ACTIONS_TYPE.SEEK_START,-1))}),"ConvivaVideojsStreamerProxy.onSeeking")},this.onSeeked=function(){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onSeeked"),_s.isSeekStarted=!1,_s.SendSeekEvent(Conviva.LivePass.SEEK_ACTIONS_TYPE.SEEK_END,-1)}),"ConvivaVideojsStreamerProxy.onSeeked")},this.onStalled=function(event,p1,p2){Utils.getInstance().runProtected((function(){}),"ConvivaVideojsStreamerProxy.onStalled")},this.onEmptied=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onEmptied")}),"ConvivaVideojsStreamerProxy.onEmptied")},this.onWaiting=function(event,p1,p2){Utils.getInstance().runProtected((function(){_s.Log("ConvivaVideojsStreamerProxy.onWaiting")}),"ConvivaVideojsStreamerProxy.onWaiting")},this.onError=function(){Utils.getInstance().runProtected((function(){if(_s.Log("ConvivaVideojsStreamerProxy.onError"),_s._vjsPlayer&&null!=_s.notifier&&null!=_s.notifier){var errorEvent=_s._vjsPlayer.error(),reportedError=_s._convertError(errorEvent?errorEvent.code:99);_s.Log("MediaError: "+errorEvent.message),_s._declareError(reportedError)}}),"ConvivaVideojsStreamerProxy.onError")},this.onProgress=function(){Utils.getInstance().runProtected((function(){if(_s._vjsPlayer&&_s._vjsPlayer.tech(_s.requestTech).hls&&_s._vjsPlayer.tech(_s.requestTech).hls.playlists.media()&&_s._vjsPlayer.tech(_s.requestTech).hls.playlists.media().attributes){var updatedStream=new StreamInfo(Math.round(_s._vjsPlayer.tech(_s.requestTech).hls.playlists.media().attributes.BANDWIDTH/1e3),null,-1,-1,-1);_s.SetStream(updatedStream)}else _s.updateBitrate()}),"ConvivaVideojsStreamerProxy.onProgress")},this.onMediaChange=function(){Utils.getInstance().runProtected((function(){if(_s.Log("ConvivaVideojsStreamerProxy.onMediaChange"),_s._vjsPlayer&&_s._vjsPlayer.tech(_s.requestTech).hls&&_s._vjsPlayer.tech(_s.requestTech).hls.playlists.media()&&_s._vjsPlayer.tech(_s.requestTech).hls.playlists.media().attributes){var updatedStream=new StreamInfo(Math.round(_s._vjsPlayer.tech(_s.requestTech).hls.playlists.media().attributes.BANDWIDTH/1e3),null,-1,-1,-1);_s.SetStream(updatedStream)}else _s.updateBitrate()}),"ConvivaVideojsStreamerProxy.onMediaChange")},this._convertError=function(code){var errStr="MEDIA_ERR_UNKNOWN",errorCode=" (code ="+code+")";switch(code){case 0:errStr="MEDIA_ERR_CUSTOM";break;case 1:errStr="MEDIA_ERR_ABORTED";break;case 2:errStr="MEDIA_ERR_NETWORK";break;case 3:errStr="MEDIA_ERR_DECODE";break;case 4:errStr="MEDIA_ERR_SRC_NOT_SUPPORTED";break;case 5:errStr="MEDIA_ERR_ENCRYPTED";break;case-1:errStr="PLAYER_ERR_NO_SRC";break;case-2:errStr="PLAYER_ERR_TIMEOUT";break;default:errStr="MEDIA_ERR_UNKNOWN"}return errStr+=errorCode,_s.Log("MediaError: code "+code+" "+errStr),errStr},_s!=STAT_INIT&&_constr.apply(_s,arguments)}function Html5PlatformApi(){var _s=this,_persistentData=null,_convivaKey="convivaPersistent";function _constr(){_s._dataLoader=new DataLoader,_s.platform=navigator&&navigator.platform&&(navigator.platform.toString?navigator.platform.toString():null)}function __getPlatformMetadata(){var res={sch:"html5.1"};return res.np=navigator&&navigator.platform&&(navigator.platform.toString?navigator.platform.toString():null),res.nua=navigator&&navigator.userAgent&&(navigator.userAgent.toString?navigator.userAgent.toString():null),res}this.cleanup=function(){null!=_s._dataLoader&&(_s._dataLoader.cleanup(),_s._dataLoader=null)},this.saveLocalData=function(data,callback){try{localStorage.setItem(_convivaKey,data)}catch(e){return void callback(!1)}callback(!0)},this.loadLocalData=function(callback){try{var data;callback(!0,localStorage.getItem(_convivaKey))}catch(e){callback(!1,"")}},this.deleteLocalData=function(){try{var data=localStorage.clear()}catch(e){}},this.httpRequest=function(isPOST,url,data,contentType,callback){return"string"!=typeof data&&(data=_s.jsonEncode(data,null)),_s._dataLoader.makeRequest(isPOST,url,data,contentType,callback)},this.epochTimeMs=function(){var d;return(new Date).getTime()},this.createTimer=function(timerAction,intervalMs,actionName){var timerId=setInterval(timerAction,intervalMs);return function(){-1!=timerId&&(clearInterval(timerId),timerId=-1)}},this.jsonEncode=function(obj){var jsonString=null;return jsonString=JSON.stringify(obj)},this.jsonDecode=function(json){var parsedJson=null;return parsedJson=JSON.parse(json)},this.consoleLog=function(message){"undefined"!=typeof console&&console.log&&console.log(message)},this.consoleErr=function(errMsg){"undefined"!=typeof console&&console.error&&console.error(errMsg)},this.getDevice=function(){return"browser"},this.getDeviceVersion=function(){return null},this.getDeviceType=function(){return"PC"},this.getOS=function(){return _s._getPlatformName()},this.getOSVersion=function(){return null},defPubMeth(_s,"getPlatformMetadata",__getPlatformMetadata),this._getPlatformName=function(){if(null==_s.platform)return null;var stringContains=function(haystack,needle){return haystack.indexOf(needle)>=0};return stringContains(_s.platform,"iPad")||stringContains(_s.platform,"iPhone")||stringContains(_s.platform,"iPod")?"IOS":stringContains(_s.platform,"Mac")?"MAC":stringContains(_s.platform,"Win")?"WIN":stringContains(_s.platform,"Linux")||stringContains(_s.platform,"SunOS")||stringContains(_s.platform,"HP-UX")||stringContains(_s.platform,"BSD")?"UNIX":stringContains(_s.platform,"PLAYSTATION 3")?"PS3":stringContains(_s.platform,"XBOX")?"XBOX":null},_s!=STAT_INIT&&_constr.apply(_s,arguments)}function ConvivaVideojsPlatformApi(){var _s=this;function _constr(){Html5PlatformApi.call(_s)}this.getPlatformMetadata=function(){var res=_s.super_getPlatformMetadata();return res.sch="videojs.1",res.fw="Video JS","undefined"!=typeof videojs&&(res.fwv=videojs.VERSION),res},_constr.apply(_s,arguments)}registerName(registerName,"registerName"),registerName(__id,"__id"),registerName(getConvivaType,"getConvivaType"),registerName(importConvivaPrivateProgram,"importConvivaPrivateProgram"),registerName(STAT_INIT,"STAT_INIT"),registerName(statInit,"statInit"),registerName(defPubMeth,"defPubMeth"),registerName(defPrivMeth,"defPrivMeth"),registerName(defStatMeth,"defStatMeth"),registerName(defGet,"defGet"),registerName(defSet,"defSet"),registerName(defStatGet,"defStatGet"),registerName(defStatSet,"defStatSet"),registerName(slIsArray,"slIsArray"),registerName(slForEachPropValue,"slForEachPropValue"),registerName(slForEachProp,"slForEachProp"),registerName(declTestClass,"declTestClass"),registerName(declTestMethod,"declTestMethod"),statInit(sluint,"sluint"),statInit(slint,"slint"),statInit(Int64,"Int64"),statInit(UInt64,"UInt64"),statInit(CandidateStream,"CandidateStream"),statInit(ConvivaContentInfo,"ConvivaContentInfo"),statInit(ConvivaStreamerProxy,"ConvivaStreamerProxy"),statInit(LivePass,"LivePass"),statInit(NetworkInfo,"NetworkInfo"),statInit(PlayerStates,"PlayerStates"),statInit(StreamInfo,"StreamInfo"),statInit(StreamSwitch,"StreamSwitch"),statInit(StreamerError,"StreamerError"),statInit(Monitor,"Monitor"),statInit(EventQueue,"EventQueue"),statInit(Session,"Session"),statInit(SessionFactory,"SessionFactory"),statInit(ArrayCS,"ArrayCS"),statInit(Cleanable,"Cleanable"),statInit(DictionaryCS,"DictionaryCS"),statInit(Eventer,"Eventer"),statInit(KeyValuePairCS,"KeyValuePairCS"),statInit(Lang,"Lang"),statInit(ListCS,"ListCS"),statInit(NativeLang,"NativeLang"),statInit(Settings,"Settings"),statInit(Utils,"Utils"),statInit(DataLoader,"DataLoader"),statInit(Infer,"Infer"),statInit(ConvivaVideojsStreamerProxy,"ConvivaVideojsStreamerProxy"),statInit(Html5PlatformApi,"Html5PlatformApi"),statInit(ConvivaVideojsPlatformApi,"ConvivaVideojsPlatformApi")}();var Conviva=void 0!==Conviva?Conviva:function(){};Conviva.LivePass=ConvivaPrivateLoader.LivePass,Conviva.ConvivaContentInfo=ConvivaPrivateLoader.ConvivaContentInfo,Conviva.StreamerError=ConvivaPrivateLoader.StreamerError,Conviva.ConvivaStreamerProxy=ConvivaPrivateLoader.ConvivaStreamerProxy,Conviva.Settings=ConvivaPrivateLoader.Settings,Conviva.StreamInfo=ConvivaPrivateLoader.StreamInfo,Conviva.Utils=ConvivaPrivateLoader.Utils,Conviva.ConvivaVideojsStreamerProxy=ConvivaPrivateLoader.ConvivaVideojsStreamerProxy,Conviva.ConvivaVideojsPlatformApi=ConvivaPrivateLoader.ConvivaVideojsPlatformApi,Conviva.Infer=ConvivaPrivateLoader.Infer}